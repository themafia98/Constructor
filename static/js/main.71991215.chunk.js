(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(t){t.exports={title:"Constructor",CabinetIcon:"/img/logo.svg",about:{developer:"Pavel Petrovich",year:"2019"}}},191:function(t,e,n){t.exports=n(458)},263:function(t,e,n){},270:function(t,e,n){},271:function(t,e,n){},272:function(t,e,n){},273:function(t,e,n){},275:function(t,e,n){},277:function(t,e,n){},278:function(t,e,n){},279:function(t,e,n){},280:function(t,e,n){},288:function(t,e,n){},289:function(t,e,n){},453:function(t,e,n){},454:function(t,e,n){},455:function(t,e,n){},456:function(t,e,n){},458:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),r=n(47),i=n.n(r),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(t,e){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}}).catch(function(t){console.error("Error during service worker registration:",t)})}var l=n(5),u=n(6),p=n(63),m={apiKey:"AIzaSyBrLv9RyGWXCeEETRqBbBo3EVOcibmnJwU",authDomain:"constructor-acb61.firebaseapp.com",databaseURL:"https://constructor-acb61.firebaseio.com",projectId:"constructor-acb61",storageBucket:"",messagingSenderId:"654914699801",appId:"1:654914699801:web:245a75eea5c628d5"},d=(n(257),n(259),new(function(){function t(e){Object(l.a)(this,t),p.initializeApp(e),this.auth=p.auth(),this.db=p.firestore()}return Object(u.a)(t,[{key:"saveSession",value:function(t){return this.auth.setPersistence(p.auth.Auth.Persistence[t])}},{key:"login",value:function(t,e){try{return this.auth.signInWithEmailAndPassword(t,e)}catch(n){return console.error(n),null}}},{key:"registration",value:function(t,e){return this.auth.createUserWithEmailAndPassword(t,e)}},{key:"signOut",value:function(){return this.auth.signOut()}},{key:"getCurrentUser",value:function(){return this.auth.currentUser}}]),t}())(m)),h=n(8),g=n(7),f=n(9),b=new(n(181).EventEmitter),v=n(43),S=(n(263),function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={redirect:!1},n.update=function(t){n.setState({redirect:!0},function(){return b.emit("EventErrorCatchUpdate")})},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return this.state.redirect?o.a.createElement(v.a,{to:"/"}):o.a.createElement("div",{class:"container"},o.a.createElement("div",{class:"flex-column"},o.a.createElement("h1",null,"Application crash"),o.a.createElement("button",{className:"button_updateApp",onClick:this.update},"Update")))}}]),e}(o.a.Component)),j=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={hasError:!1},n.updateApplication=function(t){n.setState({hasError:!1})},n.componentDidMount=function(){b.on("EventErrorCatchUpdate",n.updateApplication)},n.componentWillUnmount=function(){b.off("EventErrorCatchUpdate",n.updateApplication)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"componentDidCatch",value:function(t,e){console.error(t+","+e)}},{key:"render",value:function(){return this.state.hasError?o.a.createElement(S,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(t){return console.log(t),{hasError:!0}}}]),e}(o.a.PureComponent),E=n(32),O=n(15),C=n(42),P=n(184),y=n(2),x=n(1),w=function(t){return{type:"EXIT_PROJECT",exit:t}},k=function(t){return{type:"LOAD_CURRENT",id:t.id,typeProject:t.typeProject,sectionTitleProject:t.sectionTitleProject,components:t.components}},N=function(t){return{type:"LOAD_USER_CABINET",active:!0,idUser:t.uid,error:"",projects:t.projects}},z=function(t){return{type:"ERROR_CABINET",error:t}},I={loadProject:!1,idProject:null,typeProject:null,components:[],sectionTitleProject:[]},B={active:!1,idUser:null,projects:[],error:null},M=Object(C.c)({builder:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOAD_CURRENT":return Object(x.a)({},t,{loadProject:!0,idProject:e.id,typeProject:e.typeProject,components:Object(y.a)(e.components),sectionTitleProject:Object(y.a)(e.sectionTitleProject)});case"LOAD_UPDATE_PROJECT":return Object(x.a)({},t,{components:Object(y.a)(e.components),sectionTitleProject:Object(y.a)(e.sectionTitleProject)});case"EXIT_PROJECT":return e.exit?Object(x.a)({},t,{loadProject:!1,idProject:null,typeProject:null,components:[]}):t;default:return t}},cabinet:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOAD_USER_CABINET":return Object(x.a)({},t,{active:e.active,idUser:e.idUser,projects:Object(y.a)(e.projects)});case"CREATE_PROJECT":return Object(x.a)({},t,{projects:Object(y.a)(e.projects)});case"LOAD_UPDATE_PROJECT":return Object(x.a)({},t,{projects:t.projects.map(function(t){return t.id===e.idProject&&(t.components=Object(y.a)(e.components)),t})});case"LOG_OUT_CABINET":return Object(x.a)({},t,{active:!1,idUser:null,projects:[]});case"ERROR_CABINET":return Object(x.a)({},t,{error:e.error});default:return t}}}),T=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):C.d)(Object(C.a)(P.a.withExtraArgument({firebase:d}))),D=Object(C.e)(M,T),A=n(16),R=n.n(A),U=n(36),_=function(t,e){return function(){var n=Object(U.a)(R.a.mark(function n(a,o,r){var i;return R.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.firebase,n.next=3,i.login(t,e).then(function(t){i.db.collection("users").doc(t.user.uid).get().then(function(t){var e=t.data();a(N({uid:t.id,projects:Object(y.a)(e.projects)}))})}).catch(function(t){console.error(t.message),a(z(t.message))});case 3:case"end":return n.stop()}},n)}));return function(t,e,a){return n.apply(this,arguments)}}()},F=function(t){return function(){var t=Object(U.a)(R.a.mark(function t(e,n,a){var o;return R.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.firebase,t.next=3,o.signOut().then(function(t){e({type:"LOG_OUT_CABINET",active:!1,idUser:null,error:"",projects:[]})}).catch(function(t){console.error(t.message),e(z(t.message))});case 3:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}()},W=o.a.createContext(d),L=function(t){return function(e){return o.a.createElement(W.Consumer,null,function(n){return o.a.createElement(t,Object.assign({},e,{firebase:n}))})}},X=n(12),Y=function(t){var e=Object(a.useState)(t.path?t.path:"/img/loading.gif"),n=Object(X.a)(e,1)[0];return o.a.createElement("div",{className:"loaderBox"},o.a.createElement("img",{className:"loader",src:n,alt:"loader"}),o.a.createElement("p",null,"Loading ",t.type))},V=(n(270),L(function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={firebase:n.props.firebase,error:null},n.emailRef=null,n.passwordRef=null,n.setRefEmail=function(t){return n.emailRef=t},n.setRefPassword=function(t){return n.passwordRef=t},n.createUser=function(t){var e=n.emailRef?n.emailRef.value:null,a=n.passwordRef?n.passwordRef.value:null,o=n.props.firebase;if(!a||!e)return n.setState({error:"invalid user data"});o.registration(e,a).then(function(t){if(!t)throw new Error("Ivaid registration");o.db.collection("users").doc(t.user.uid).set({projects:[],email:e}).then(function(){return b.emit("EventRegistrationCorrect",t)})}).catch(function(t){console.error(t.message),n.setState({error:t.message})})},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.state.error;return o.a.createElement("div",{className:"RegistrationBox"},o.a.createElement("div",{className:"RegistrationForm"},o.a.createElement("h3",null,"Registration"),o.a.createElement("form",{autoComplete:"off",className:"RegForm"},t?o.a.createElement("p",{className:"error"},t):null,o.a.createElement("span",null,"E-mail"),o.a.createElement("input",{ref:this.setRefEmail,type:"text"}),o.a.createElement("span",null,"Password"),o.a.createElement("input",{className:"password",autoComplete:"off",ref:this.setRefPassword,type:"password"}),o.a.createElement("input",{onClick:this.createUser,className:"loginButton",type:"button",value:"registration"}))))}}]),e}(o.a.PureComponent))),J=(n(271),function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={title:"Constructor",registrationActive:!1,regStatus:!1,wrongEnter:!1,error:""},n.emailImput=null,n.passwordImput=null,n.statusRegistration=function(t){t.additionalUserInfo.isNewUser?n.setState(Object(x.a)({},n.state,{regStatus:!0,registrationActive:!1,error:"Account create!"})):console.error("error registration")},n.showBox=function(t){n.setState(Object(x.a)({},n.state,{registrationActive:!n.state.registrationActive})),t.stopPropagation()},n.authTo=function(t){n.emailImput&&n.passwordImput&&n.props.dispatch(_(n.emailImput.value,n.passwordImput.value)),t.stopPropagation()},n.emailRef=function(t){return n.emailImput=t},n.passwordRef=function(t){return n.passwordImput=t},n.componentDidMount=function(t){b.on("EventRegistrationCorrect",n.statusRegistration)},n.componentWillUnmount=function(t){b.off("EventRegistrationCorrect",n.statusRegistration)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return this.props.active?o.a.createElement(v.a,{to:"/Cabinet"}):this.props.active?o.a.createElement(Y,{path:"/img/loading.gif",type:"session"}):o.a.createElement("div",{className:"LoginPage flex-column"},o.a.createElement("h1",null,this.state.title),o.a.createElement("div",{className:"LoginBox"},o.a.createElement("div",{className:"LoginForm"},o.a.createElement("h3",null,"Connect form"),this.props.wrongEnter||this.state.regStatus?o.a.createElement("p",{className:"error"},this.props.wrongEnter):null,o.a.createElement("p",null,"E-mail"),o.a.createElement("input",{ref:this.emailRef,type:"text"}),o.a.createElement("p",null,"Password"),o.a.createElement("input",{ref:this.passwordRef,type:"password"}),o.a.createElement("input",{onClick:this.authTo,className:"loginButton enterInput",type:"button",value:"enter"}),o.a.createElement("input",{onClick:this.showBox,className:this.state.registrationActive?"loginButton registration selected":"loginButton registration",type:"button",value:"registration"}))),this.state.registrationActive?o.a.createElement(V,null):null)}}]),e}(o.a.PureComponent)),H=Object(O.b)(function(t){return{active:t.cabinet.active,wrongEnter:t.cabinet.error}})(J),K=function(t){return function(){var e=Object(U.a)(R.a.mark(function e(n,a,o){var r;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.firebase,e.next=3,r.db.collection("users").doc(t.uid).get().then(function(t){return t.data()}).then(function(e){return{id:e.id,projects:e.projects.filter(function(e){return e.id!==t.id})}}).then(function(e){r.db.collection("users").doc(t.uid).update({projects:e.projects}).then(function(t){n(N({uid:e.id,projects:e.projects}))})}).catch(function(t){console.error(t.message),n(z(t.message))});case 3:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()};n(272);var Z=function(t){var e=Object(a.useState)(t.path),n=Object(X.a)(e,1)[0],r=Object(a.useState)(t.className?t.className:null),i=Object(X.a)(r,1)[0],c=Object(a.useState)(!!t.draggable),s=Object(X.a)(c,1)[0];return o.a.createElement("img",{draggable:s,onClick:t.onClick?t.onClick:null,className:i,title:t.title?t.title:null,src:"/constructor"+n,alt:"icon"})},G=(n(273),function(t){return o.a.createElement("div",{className:"wrapperConfirm"},o.a.createElement("div",{className:"confirmSave"},o.a.createElement("span",null,"Detected new changes"),o.a.createElement("input",{className:"saveCofirm",onClick:t.cbSaveChanges,type:"button",value:"Save changes"}),o.a.createElement("input",{className:"cancelCofirm",onClick:t.cbCancelSave,type:"button",value:"Cancel"})))}),q=n(104).CabinetIcon,$=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={title:n.props.title,isChange:!1,redirectConfirm:!1,redirectAbout:{path:"/Cabinet/About",redirectA:!1},redirectCabinet:{path:"/Cabinet",redirectC:!1}},n.confirm=function(t){n.setState({isChange:t})},n.confirmSaveDetectChanges=function(t){b.emit("EventRedirectSaveChanges"),n.setState({redirectConfirm:!1,redirectCabinet:Object(x.a)({},n.state.redirectCabinet,{redirectC:!0})})},n.logOut=function(t){n.props.idUser&&n.props.dispatch(F(n.props.idUser)),t.stopPropagation()},n.redirectAbout=function(t){n.props.location.pathname!==n.state.redirectAbout.path&&!n.state.isChange?n.setState({redirectConfirm:!1,redirectAbout:Object(x.a)({},n.state.redirectAbout,{redirectA:!0})}):n.setState({redirectConfirm:!0}),t.stopPropagation()},n.redirectCabinet=function(t){"cancelMode"!==t?(n.props.location.pathname!==n.state.redirectCabinet.path&&!n.state.isChange?n.setState({redirectConfirm:!1,redirectCabinet:Object(x.a)({},n.state.redirectCabinet,{redirectC:!0})}):n.setState({redirectConfirm:!0}),t.stopPropagation()):n.setState({redirectConfirm:!1,redirectCabinet:Object(x.a)({},n.state.redirectCabinet,{redirectC:!0})})},n.add=function(t){b.emit("EventChangeWorkMode",{action:"newProject"}),t.stopPropagation()},n.componentWillMount=function(){b.on("EventRedirectConfirm",n.confirm)},n.componentWillUnmount=function(){b.off("EventRedirectConfirm",n.confirm)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this,e=this.state.redirectAbout.redirectA,n=this.state.redirectCabinet.redirectC;return e?o.a.createElement(v.a,{to:this.state.redirectAbout.path}):n?o.a.createElement(v.a,{to:this.state.redirectCabinet.path}):o.a.createElement(o.a.Fragment,null,this.state.isChange&&this.state.redirectConfirm?o.a.createElement(G,{cbSaveChanges:this.confirmSaveDetectChanges,cbCancelSave:function(){return t.redirectCabinet("cancelMode")}}):null,o.a.createElement("header",null,o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"flex-row"},o.a.createElement("div",{onClick:this.redirectCabinet,className:"header__CabinetInfo"},o.a.createElement(Z,{className:"mainIcon",path:q}),o.a.createElement("h3",{className:"tilteApp"},this.state.title)),"/Cabinet"===this.props.location.pathname?o.a.createElement("div",{onClick:this.add,className:"header__newProject__AddButton"},o.a.createElement(Z,{className:"Cabinet",path:"/img/plus.png"})):null,o.a.createElement("div",{className:"Navigator"},o.a.createElement(Z,{className:"about",onClick:this.redirectAbout,title:"about",path:"/img/about_logo.svg"}),o.a.createElement(Z,{className:"logoutButton",onClick:this.logOut,title:"logOut",path:"/img/logOut.svg"}))))))}}]),e}(o.a.Component),Q=Object(O.b)()(Object(v.g)($)),tt=n(62),et=n(185),nt=n.n(et),at=function(t){var e=Object(a.useState)(t.id),n=Object(X.a)(e,1)[0],r=Object(a.useState)(t.urls.regular),i=Object(X.a)(r,1)[0],c=Object(a.useState)(t.urls.full),s=Object(X.a)(c,1)[0],l=Object(a.useState)(t.isFull),u=Object(X.a)(l,1)[0];return o.a.createElement("div",{className:t.selected?"ItemBox selected":"ItemBox"},o.a.createElement("img",{className:"ImageItem",onClick:function(t){b.emit("EventShowMenuImage",{id:n,url:i,urlFull:s})},src:u?s:i,alt:"item"}))};n(275);n(276).polyfill();var ot=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(r)))).state={workMode:n.props.workMode,images:{buttonSearchDisabled:!1,selectedItem:null,showUrl:null,images:null,urlFull:null,imageBoxView:!1,error:""},newProject:{validateName:!1,validateType:!1,disabled:!0,name:"",type:"empty"},imageMenuActive:!1,warning:{lengthMax:"Max length: 20 symbols",lengthMin:"Min length: 4 symbol",type:"Select type of webpage"}},n.inputSearch=null,n.inputSelect=null,n.searchBackground=function(t){var e="https://api.unsplash.com/".concat("search/photos/?page=1&per_page=40&query="),a=n.inputSearch.value;n.setState(Object(x.a)({},n.state,{images:Object(x.a)({},n.state.inages,{buttonSearchDisabled:!0})})),nt()("".concat(e+a,"&client_id=").concat("421b12ae729e1f6e4a0cac207496874099ab8a738378ec07a8e2598b11201802")).then(function(t){if(t.ok)return t.json();throw new Error("request invalid")}).then(function(t){var e=t.results;if(!e.length)throw new Error("Photos not found");n.setState(Object(x.a)({},n.state,{images:Object(x.a)({},n.state.images,{imageBoxView:!0,error:"",images:Object(y.a)(e),buttonSearchDisabled:!1})}))}).catch(function(t){console.error(t.message),n.setState(Object(x.a)({},n.state,{images:Object(x.a)({},n.state.images,{error:t.message}),imageBoxView:!1,buttonSearchDisabled:!1}))})},n.showMenuImage=function(t){n.setState(Object(x.a)({},n.state,{imageMenuActive:!0,images:Object(x.a)({},n.state.images,{selectedItem:t.id,showUrl:t.url,urlFull:t.urlFull})}))},n.showImage=function(t){var e=n.state.images.showUrl;b.emit("EventImageView",{action:!0,target:e||null}),t.stopPropagation()},n.setSelectedImage=function(t){var e=Object(x.a)({},n.state.images);"image"!==n.props.modalSearchMode?(b.emit("EventSetBackgroundImage".concat(n.props.idComponent),e),b.emit("EventSetBImageInstumentPanel",{images:e,mode:n.props.modalSearchMode})):(b.emit("EventSetCurrentImage".concat(n.props.idComponent),e),b.emit("EventSetBImageInstumentPanel",{images:e,mode:n.props.modalSearchMode})),t.stopPropagation()},n.makeImageResultBox=function(t){return t?t.map(function(t,e){return o.a.createElement(at,{key:"item".concat(e),id:e,selected:n.state.images.selectedItem===e,isFull:!1,urls:Object(x.a)({},t.urls)})}):null},n.addNewProject=function(t){var e=n.state[n.state.workMode];e.validateType&&e.validateName&&(b.emit("EventAddProject",{title:n.state[n.state.workMode].name,type:n.state[n.state.workMode].type}),b.emit("EventChangeWorkMode",{action:"default"}))},n.selectOption=function(t){var e=Object(x.a)({},n.state[n.state.workMode]);e.type=t.target.value,e.validateType="empty"!==e.type,e.disabled=!e.validateType||!e.validateName,n.setState(Object(x.a)({},n.state,Object(tt.a)({},n.state.workMode,e)))},n.validateName=function(t){var e=Object(x.a)({},n.state[n.state.workMode]);e.name=t.target.value;var a=e.name.length;e.validateName=a>=4&&a<20,e.disabled=!e.validateType||!e.validateName,n.setState(Object(x.a)({},n.state,Object(tt.a)({},n.state.workMode,e)))},n.cancel=function(t){"Search"===n.state.workMode?b.emit("EventModalSearchOn",{action:"offline",mode:null}):b.emit("EventChangeWorkMode",{action:"default"})},n.refSelect=function(t){return n.inputSelect=t},n.refSearch=function(t){return n.inputSearch=t},n.componentDidMount=function(t){"Search"===n.state.workMode&&b.on("EventShowMenuImage",n.showMenuImage)},n.componentWillUnmount=function(t){"Search"===n.state.workMode&&b.off("EventShowMenuImage",n.showMenuImage)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){switch(this.state.workMode){case"newProject":return o.a.createElement("div",{className:"Modal"},o.a.createElement("h3",null,"Create new Project"),this.state[this.state.workMode].name.length<=3?o.a.createElement("span",{className:"warning"},this.state.warning.lengthMin):null,this.state[this.state.workMode].name.length>=20?o.a.createElement("span",{className:"warning"},this.state.warning.lengthMax):null,o.a.createElement("input",{className:this.state[this.state.workMode].validateName?"ready":"wrong",value:this.state[this.state.workMode].name,onChange:this.validateName,type:"text",placeholder:"Project name"}),this.state[this.state.workMode].validateType?null:o.a.createElement("span",{className:"warning"},this.state.warning.type),o.a.createElement("select",{onChange:this.selectOption},o.a.createElement("option",{value:"empty"},"--------"),o.a.createElement("option",{value:"landing"},"Landing"),o.a.createElement("option",{value:"portfolio"},"Portfolio")),o.a.createElement("input",{onClick:this.addNewProject,className:"acceptButton",disabled:this.state[this.state.workMode].disabled,type:"button",value:"Submit"}),o.a.createElement("input",{onClick:this.cancel,type:"button",value:"Cancel"}));case"Search":return console.log(this.props),o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:"Modal Modal-search"},o.a.createElement("h3",null,"Search ".concat("image"!==this.props.modalSearchMode?"background image":"image")),this.state.images.error?o.a.createElement("span",{className:"error"},this.state.images.error):null,o.a.createElement("input",{ref:this.refSearch,type:"text",placeholder:"Photo name"}),o.a.createElement("input",{disabled:this.state.images.buttonSearchDisabled,className:"acceptButton",type:"button",value:"Search",onClick:this.searchBackground}),o.a.createElement("input",{onClick:this.cancel,type:"button",value:"Cancel"}),this.state.images.imageBoxView?o.a.createElement("div",{className:"searchResultBox"},this.makeImageResultBox(Object(y.a)(this.state.images.images))):null),this.state.imageMenuActive?o.a.createElement("div",{className:"ActionModalSearch"},o.a.createElement("button",{onClick:this.showImage,className:"actionModalSearch__view"},o.a.createElement(Z,{path:"/img/view.png"})),o.a.createElement("button",{onClick:this.setSelectedImage,className:"actionModalSearch__settings"},o.a.createElement(Z,{path:"/img/settings.png"}))):null);case"SearchImage":return o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:"Modal Modal-search"},o.a.createElement("h3",null,"Search background image"),this.state.images.error?o.a.createElement("span",{className:"error"},this.state.images.error):null,o.a.createElement("input",{ref:this.refSearch,type:"text",placeholder:"Photo name"}),o.a.createElement("input",{disabled:this.state.images.buttonSearchDisabled,className:"acceptButton",type:"button",value:"Search",onClick:this.searchBackground}),o.a.createElement("input",{onClick:this.cancel,type:"button",value:"Cancel"}),this.state.images.imageBoxView?o.a.createElement("div",{className:"searchResultBox"},this.makeImageResultBox(Object(y.a)(this.state.images.images))):null),this.state.imageMenuActive?o.a.createElement("div",{className:"ActionModalSearch"},o.a.createElement("button",{onClick:this.showImage,className:"actionModalSearch__view"},o.a.createElement(Z,{path:"/img/view.png"})),o.a.createElement("button",{onClick:this.setSelectedImage,className:"actionModalSearch__settings"},o.a.createElement(Z,{path:"/img/settings.png"}))):null);default:return o.a.createElement(a.Fragment,null)}}}]),e}(o.a.PureComponent);var rt=function(t,e,n,a){return function(){var o=Object(U.a)(R.a.mark(function o(r,i,c){var s,l,u,p,m;return R.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=c.firebase,l=Object(y.a)(e),u=l.length?l[l.length-1].id+1:0,(p=[]).push("Header"),m={backgroundImage:null,color:null,id:"MainBackgroundHeader".concat((i=0,d=1e4,"".concat(Math.floor(i+Math.random()*(d-i))))),targetSection:"Header",type:"background"},l.push({id:u,title:n,type:a,components:[m],sectionTitleProject:[].concat(p)}),o.next=9,s.db.collection("users").doc(t).update({projects:l}).then(function(){return r({type:"CREATE_PROJECT",projects:l})}).catch(function(t){console.error(t.message),r(z(t.message))});case 9:case"end":return o.stop()}var i,d},o)}));return function(t,e,n){return o.apply(this,arguments)}}()};n(277);var it=Object(v.g)(function(t){var e=Object(a.useState)("/Cabinet/Build/".concat(t.id)),n=Object(X.a)(e,1)[0],r=Object(a.useState)(!1),i=Object(X.a)(r,2),c=i[0],s=i[1],l=Object(a.useState)(t.id),u=Object(X.a)(l,1)[0],p=Object(a.useState)(t.name),m=Object(X.a)(p,1)[0],d=Object(a.useState)(t.type),h=Object(X.a)(d,1)[0];return c?o.a.createElement(v.a,{to:n}):o.a.createElement("div",{className:"item","data-id":u},o.a.createElement("p",{className:"ProjectName"},m),o.a.createElement("p",{className:"ProjectType"},h),o.a.createElement("div",{className:"projectController"},o.a.createElement("input",{onClick:function(e){t.location.pathname!==n&&s(!0),e.stopPropagation()},className:"projectControllerButton_enter",type:"button",value:"enter build"}),o.a.createElement("input",{onClick:function(e){b.emit("EventDeleteItem",{id:t.id,name:t.name,type:t.type}),e.stopPropagation()},className:"projectControllerButton_delete",type:"button",value:"delete"})),o.a.createElement("input",{onClick:function(t){t.stopPropagation()},className:"productionButton",type:"button",value:"Show demo"}))}),ct=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(r)))).state={redirect:!1},n.addNewProject=function(t){n.props.idUser?n.props.dispatch(rt(n.props.idUser,n.props.list,t.title,t.type)):n.setState(Object(x.a)({},n.state,{redirect:!0}))},n.makeList=function(t){return t.map(function(t){return o.a.createElement(it,{key:t.id,id:t.id,name:t.title,type:t.type})})},n.componentDidMount=function(){b.on("EventAddProject",n.addNewProject)},n.componentWillUnmount=function(){b.off("EventAddProject",n.addNewProject)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return this.state.redirect?o.a.createElement(v.a,{to:"/"}):o.a.createElement("div",{className:"projectsList__list"},this.makeList(Object(y.a)(this.props.list)))}}]),e}(o.a.PureComponent),st=Object(O.b)(function(t){return{idUser:t.cabinet.idUser,list:Object(y.a)(t.cabinet.projects)}})(ct),lt=(n(278),function(t){return o.a.createElement("section",{className:"projectsList"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"flex-column"},o.a.createElement("div",{className:"projectsList__about"},o.a.createElement("h3",null,"Your Projects")),st?o.a.createElement(st,null):null)))}),ut=(n(279),n(104).title),pt=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={workMode:"default"},n.logOut=function(){n.props.dispatch(F(n.props.idUser))},n.deletItem=function(t){n.props.dispatch(K(Object(x.a)({},t,{uid:n.props.firebase.getCurrentUser().uid})))},n.changeWorkMode=function(t){n.setState(Object(x.a)({},n.state,{workMode:t.action}))},n.componentDidMount=function(){b.on("EventDeleteItem",n.deletItem),b.on("EventChangeWorkMode",n.changeWorkMode)},n.componentWillUnmount=function(){b.off("EventDeleteItem",n.deletItem),b.off("EventChangeWorkMode",n.changeWorkMode)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return this.props.active?o.a.createElement(a.Fragment,null,o.a.createElement(Q,{title:ut,idUser:this.props.idUser}),o.a.createElement("div",{className:"Cabinet"},"newProject"===this.state.workMode?o.a.createElement(ot,{workMode:this.state.workMode}):null,o.a.createElement(lt,null))):this.props.firebase.getCurrentUser()?o.a.createElement(Y,{path:"/img/loading.gif",type:"Cabinet"}):o.a.createElement(v.a,{to:"/"})}}]),e}(o.a.PureComponent),mt=Object(O.b)(function(t){return{idUser:t.cabinet.idUser,projects:Object(y.a)(t.cabinet.projects),active:t.cabinet.active}})(L(pt)),dt=function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(g.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.a.createElement("div",null,"PRODUCTION")}}]),e}(o.a.PureComponent),ht=Object(O.b)(function(t){return{idUser:t.cabinet.idUser,projects:Object(y.a)(t.cabinet.projects),active:t.cabinet.active}})(L(dt)),gt=(n(280),L(function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={config:n.props.config},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){if(this.props.firebase.getCurrentUser()){var t=this.state.config;return o.a.createElement(a.Fragment,null,o.a.createElement(Q,{title:t.title}),o.a.createElement("section",{className:"About"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"col-12"},o.a.createElement("div",{className:"information"},o.a.createElement("img",{alt:"img",className:"logoAbout",src:"/constructor/img/about.jpg"}),o.a.createElement("p",{className:"developer"},o.a.createElement("span",null,"Developer:")," ",t.about.developer),o.a.createElement("p",{className:"year"},o.a.createElement("span",null,"Year:")," ",t.about.year))))))}return o.a.createElement(v.a,{to:"/"})}}]),e}(o.a.PureComponent))),ft=n(90),bt=function(t){return function(){var e=Object(U.a)(R.a.mark(function e(n,a,o){var r,i;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.firebase,i=t.projects.map(function(e){return e.id===t.idProject&&(e.components=Object(y.a)(t.components),e.sectionTitleProject=Object(y.a)(t.sectionTitleProject)),e}),e.next=4,r.db.collection("users").doc(t.uid).update({projects:JSON.parse(JSON.stringify(i))}).then(function(e){var a,o=t.projects.find(function(e){return e.id===t.idProject});n({type:"LOAD_UPDATE_PROJECT",idProject:(a={components:Object(y.a)(o.components),idProject:t.idProject,sectionTitleProject:t.sectionTitleProject}).idProject,sectionTitleProject:a.sectionTitleProject,components:a.components})}).catch(function(t){return n(z(t.message))});case 4:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()};n(288);var vt=function(t){var e=Object(a.useState)(t.path),n=Object(X.a)(e,1)[0];return o.a.createElement("div",{onClick:function(t){b.emit("EventImageView",{action:!1,target:null}),t.stopPropagation()},className:"ImageViewer"},o.a.createElement("img",{src:n,alt:"fullImage"}))},St=(n(289),function(t){t.componentStats.content;var e=t.componentStats.fontSize,n=t.componentStats.coords;return o.a.createElement(a.Fragment,null,o.a.createElement("p",{className:"titleInstument"},"Position: "),o.a.createElement("span",{className:"textCoordsPanel"},n.x?n.x+" / "+n.y:" drop for active"),o.a.createElement("p",{className:"titleInstument"},"Size: "),o.a.createElement("input",{onChange:t.cbSetSize,type:"number",min:"10",max:"200",value:e||120}),o.a.createElement("p",{className:"titleInstument"},"Content: "),o.a.createElement("input",{onClick:t.cbSearchImage,className:"ImageSearchButton",type:"button",value:"search media"}))}),jt=function(t){var e=t.componentStats.fontSize;return o.a.createElement(a.Fragment,null,o.a.createElement("p",{className:"titleInstument"},"Width (%):"),o.a.createElement("input",{onChange:t.cbSetSize,type:"number",min:"10",max:"100",value:e||100}),o.a.createElement("p",{className:"titleInstument"},"Height (%):"),o.a.createElement("input",{onChange:t.cbSetSize,type:"number",min:"10",max:"100",value:e||100}),o.a.createElement("p",{className:"titleInstument"},"Border radius: "),o.a.createElement("input",{onChange:t.cbSetBorderRadius,className:"button_switch radius",type:"number",value:t.componentStats.borderRadius?t.componentStats.borderRadius:10,min:"10",max:"200"}),o.a.createElement("p",{className:"titleInstument titleInstrument__opacity"},"Opacity: "),o.a.createElement("input",{onChange:t.cbSetOpacity,className:"ImageSearchButton",type:"number",value:t.componentStats.opacity?t.componentStats.opacity:1,step:"0.1",min:"0",max:"1"}),o.a.createElement("input",{onClick:t.cbSearchImage,className:"ImageSearchButton",type:"button",value:"search image"}))},Et=n(89),Ot=function(t){var e=Object(a.useState)(t.componentStats).componentsStats,n=null;return"object"===typeof e&&e.hasOwnProperty("color")&&(n=e.color),o.a.createElement(a.Fragment,null,o.a.createElement("p",{className:"titleInstument"},"Color: "),o.a.createElement("input",{onClick:t.cbSetColor,className:"button_switch Color",type:"button",value:"color pick"}),t.colorPickerActive?o.a.createElement(Et.SketchPicker,{onChangeComplete:t.cbHandleChangeComplete,color:n||"red"}):null,o.a.createElement("input",{onClick:t.cbSearchImage,className:"ImageSearchButton",type:"button",value:"background-image"}))},Ct=function(t){var e=t.instrumentPanel.colorPickerActive,n=t.componentStats.content,r=t.componentStats.fontSize,i=t.componentStats.coords,c=t.componentStats.color,s=""!==n?"Title":"";return o.a.createElement(a.Fragment,null,o.a.createElement("p",{className:"titleInstument"},"Position: "),o.a.createElement("span",{className:"textCoordsPanel"},i.x?i.x+" / "+i.y:" drop for active"),o.a.createElement("p",{className:"titleInstument"},"Color: "),o.a.createElement("input",{onClick:t.cbSetColor,className:"button_switch",type:"button",value:"color pick"}),o.a.createElement("p",{className:"titleInstument"},"Text size: "),o.a.createElement("input",{onChange:t.cbSetSize,type:"number",min:"10",max:"200",value:r||120}),e?o.a.createElement(Et.SketchPicker,{onChangeComplete:t.cbHandleChangeComplete,color:c||"red"}):null,o.a.createElement("p",{className:"titleInstument"},"Font: "),o.a.createElement("select",{value:t.componentStats.font,onChange:t.cbSetFont},o.a.createElement("option",null,"Arial"),o.a.createElement("option",null,"Times"),o.a.createElement("option",null,"Georgia"),o.a.createElement("option",null,"Impact"),o.a.createElement("option",null,"Tahoma"),o.a.createElement("option",null,"Verdana"),o.a.createElement("option",null,"Comic")),o.a.createElement("p",{className:"titleInstument"},"Content: "),o.a.createElement("input",{onChange:t.cbSetContent,maxLength:"100",type:"text",value:n||s}))},Pt=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(r)))).state={instrumentPanel:Object(x.a)({},n.props.instrumentPanel),componentStats:n.props.componentStats,images:null},n.timer=null,n.updateSize=function(t){n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats,{fontSize:t})}))},n.closePanel=function(t){b.emit("EventClosePanel",{close:!1})},n.setSize=function(t){var e=n.state.componentStats.id,a=t.target.value>200?200:t.target.value;n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats,{fontSize:a})}),function(){return b.emit("EventChangeSize".concat(e),{targetSection:n.state.editComponentName,size:a})})},n.setFont=function(t){var e=n.state.componentStats.id,a=t.target.value;n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats,{font:a})}),function(){return b.emit("EventSetFont".concat(e),{targetSection:n.state.editComponentName,font:a})})},n.setContent=function(t){var e=n.state.componentStats.id,a=t.target.value;n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats,{content:a})}),function(){return b.emit("EventChangeContentText".concat(e),{targetSection:n.state.editComponentName,content:a})})},n.updatePosition=function(t){t&&n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{coords:Object(x.a)({},n.state.componentStats.coords,{x:t.x,y:t.y})})}))},n.setColor=function(t){n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel,{colorPickerActive:!n.state.instrumentPanel.colorPickerActive})}))},n.setOpacity=function(t){var e=n.state.componentStats.id,a=t.target.value;n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{opacity:a})}),function(){return b.emit("EventSetOpacity".concat(e),{opacity:a})})},n.setBorderRadius=function(t){var e=n.state.componentStats.id,a=t.target.value;n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{borderRadius:a})}),function(){return b.emit("EventSetBorderRadius".concat(e),{borderRadius:a})})},n.updateBimageStats=function(t){var e=t.images;"image"!==t.mode?n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{backgroundImage:e.urlFull})})):n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{image:e.urlFull})}))},n.handleChangeComplete=function(t){var e=t.rgb,a="rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")"),o=n.state.componentStats.id;"background"===n.state.componentStats.type?n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{color:a})}),function(){return b.emit("EventChangeColorBackground".concat(o),{colorRGB:n.state.componentStats.color})}):"text"===n.state.componentStats.type&&n.setState(Object(x.a)({},n.state,{componentStats:Object(x.a)({},n.state.componentStats,{color:a})}),function(){return b.emit("EventChangeColorText".concat(o),a)})},n.redirectSaveChanges=function(t){b.emit("EventSaveChangesComponent",Object(x.a)({},n.state.componentStats,{id:n.state.componentStats.id,type:n.state.componentStats.type}))},n.saveChanges=function(t){n.timer&&clearTimeout(n.timer),n.timer=setTimeout(function(){b.emit("EventSaveChangesComponent",Object(x.a)({},n.state.componentStats,{id:n.state.componentStats.id,type:n.state.componentStats.type})),b.emit("EventRedirectConfirm",!1)},2e3),b.emit("EventRedirectConfirm",!0),t&&t.stopPropagation()},n.searchImage=function(t){var e=n.state.componentStats.id;b.emit("EventModalSearchOn",{idComponent:e,mode:n.state.componentStats.type}),t.stopPropagation()},n.makePanelInstruments=function(t){switch(t){case"text":return o.a.createElement(Ct,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats),cbSetColor:n.setColor,cbSetSize:n.setSize,cbHandleChangeComplete:n.handleChangeComplete,cbSetContent:n.setContent,cbSetFont:n.setFont,cbSetOpacity:n.setOpacity});case"background":return o.a.createElement(Ot,{colorPickerActive:n.state.instrumentPanel.colorPickerActive,componentStats:Object(x.a)({},n.state.componentStats),cbSetColor:n.setColor,cbHandleChangeComplete:n.handleChangeComplete,cbSearchImage:n.searchImage});case"image":return console.log(n.state.componentStats),console.log(n.props),o.a.createElement(jt,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats),cbSearchImage:n.searchImage,cbSetSize:n.setSize,cbSetBorderRadius:n.setBorderRadius,cbSetOpacity:n.setOpacity});case"media":return o.a.createElement(St,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentStats:Object(x.a)({},n.state.componentStats),cbSearchImage:n.searchImage});default:return o.a.createElement("p",{className:"warningInstruments"},"No found element")}},n.componentDidUpdate=function(t,e){console.log("ip componentDidUpdate"),e.componentStats!==n.state.componentStats&&n.saveChanges()},n.componentDidMount=function(t){b.on("EventRedirectSaveChanges",n.redirectSaveChanges),b.on("EventupdateSize".concat(n.state.componentStats.id),n.updateSize),b.on("EventSetBImageInstumentPanel",n.updateBimageStats),b.on("EventUpdatePosition".concat(n.state.componentStats.id),n.updatePosition)},n.componentWillUnmount=function(t){n.timer&&clearTimeout(n.timer),b.off("EventRedirectSaveChanges",n.redirectSaveChanges),b.off("EventupdateSize".concat(n.state.componentStats.id),n.updateSize),b.off("EventSetBImageInstumentPanel",n.updateBimageStats),b.off("EventUpdatePosition".concat(n.state.componentStats.id),n.updatePosition)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.state.instrumentPanel.instrumentActive;return console.log("ip"),o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:"instumentsPanel"},o.a.createElement("button",{onClick:this.closePanel,className:"closeInstrumentsPanel"},o.a.createElement(Z,{path:"/img/close.svg"})),o.a.createElement("h3",null,"Instruments"),t?o.a.createElement("p",{className:"TextComponent"},this.state.componentStats.type):null,t?o.a.createElement("div",{className:"instuments"},this.makePanelInstruments(this.state.componentStats.type)):null))}}]),e}(o.a.PureComponent),yt=function(t){return o.a.createElement(a.Fragment,{key:"AdditionalBuild"},t.modalImageViewer.action&&o.a.createElement(vt,{key:"ImageViewer",path:t.modalImageViewer.target}),t.modalSearch&&o.a.createElement(ot,{idComponent:t.componentStats.id,modalSearchMode:t.modalSearchMode,key:"ModalWindow",workMode:"Search"}),o.a.createElement(Pt,{key:"InstrumentsPanel".concat(t.componentStats.id),editComponentName:t.editComponentName,componentStats:Object(x.a)({},t.componentStats),mainBuilderData:t.mainBuilderData,instrumentPanel:t.instrumentPanel}))},xt=n(22),wt=n(23);function kt(){var t=Object(xt.a)(["\n    width: ",";\n    height: ",";\n    position: absolute;\n    pointer-events: none;\n"]);return kt=function(){return t},t}var Nt=wt.a.input.attrs(function(t){return{style:{zIndex:t.indexZ?"9999":null,left:t.coordX?t.coordX:"45%",top:t.coordY?t.coordY:"0%"}}})(kt(),function(t){return t.size?t.size+"%":null},function(t){return t.size?t.size+20+"%":null}),zt=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={id:n.props.id,istrumentsActive:!1,getSizeBool:!1,sizeParentBox:n.props.sizeParentBox,targetSection:n.props.targetSection,path:n.props.path,size:n.props.size?n.props.size:null,shiftCoords:null,posImage:n.props.coords.x?{x:n.props.coords.x,y:n.props.coords.y}:null,startDragNdrop:!1},n.openImageInstruments=function(t){var e={id:n.state.id,targetSection:n.state.targetSection,type:"image",borderRadius:null,opacity:1,zIndex:null,image:n.state.path,coords:Object(x.a)({},n.state.posImage)};b.emit("EventInstrumentPanel",{componentStats:e,targetSection:n.state.targetSection,id:n.state.id,sizeTextValue:n.state.size}),n.setState(Object(x.a)({},n.state,{istrumentsActive:!0})),t.stopPropagation()},n.saveCoords=function(t){if(1!==t.nativeEvent.which)return!1;var e=n.refInput.getBoundingClientRect(),a=e.left,o=e.top;e.right,e.left,e.bottom,e.top;n.setState(Object(x.a)({},n.state,{shiftCoords:{x:t.clientX-a,y:t.clientY-o},startDragNdrop:!n.state.startDragNdrop})),t.stopPropagation()},n.checkPivotPosition=function(t,e){var a=n.refInput.getBoundingClientRect(),o=800-a.height,r=n.props.sizeParentBox.width-a.width;return e<0&&(e=0),e>o&&(e=o),t<0&&(t=0),t>r&&(t=r),{x:t,y:e}},n.delta=function(t,e){return{x:0,y:0}},n.move=function(t,e){return n.setState(Object(x.a)({},n.state,{posImage:{x:t,y:e}}))},n.moveText=function(t){if(n.state.startDragNdrop&&n.state.istrumentsActive){var e=t.clientX-n.props.sizeParentBox.left,a=t.clientY-n.props.sizeParentBox.top,o=e-n.state.shiftCoords.x+n.delta().x,r=a-n.state.shiftCoords.y+n.delta().y,i=n.checkPivotPosition(o,r),c=100*i.x/n.state.sizeParentBox.width,s=100*i.y/n.state.sizeParentBox.height;n.move(c.toFixed(2)+"%",s.toFixed(2)+"%")}t.stopPropagation()},n.stopDragNdrop=function(t){n.state.startDragNdrop&&(n.setState(Object(x.a)({},n.state,{startDragNdrop:!1})),b.emit("EventUpdatePosition".concat(n.state.id),n.state.posImage)),t.stopPropagation()},n.setCurrentImage=function(t){var e=t.urlFull;n.setState(Object(x.a)({},n.state,{path:e}))},n.weelResizeText=function(t){if(t.shiftKey&&-100===t.deltaY){var e=n.state.size+1;e=e>100?100:e,n.setState(Object(x.a)({},n.state,{size:e})),b.emit("EventupdateSize",e)}if(t.shiftKey&&100===t.deltaY){var a=n.state.size-1;a=a<=0?0:a,n.setState(Object(x.a)({},n.state,{size:a})),b.emit("EventupdateSize",a)}t.stopPropagation()},n.saveSize=function(t){if(n.state.getSizeBool)b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize);else{var e=t.size;n.setState(Object(x.a)({},n.state,{getSizeBool:!0,sizeParentBox:{width:e.width,height:e.height}}))}},n.refInput=null,n.refInputComponent=function(t){return n.refInput=t},n.componentDidMount=function(){b.on("EventSetCurrentImage".concat(n.state.id),n.setCurrentImage),b.on("EventSaveWidth".concat(n.state.targetSection),n.saveSize)},n.componentWillUnmount=function(){b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize),b.off("EventSetCurrentImage".concat(n.state.id),n.setCurrentImage)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.a.createElement(Nt,{type:"button",value:"Input",ref:this.refInputComponent,size:this.state.size,onClick:this.openImageInstruments,onMouseDown:this.saveCoords,onMouseMove:this.moveText,onMouseLeave:this.stopDragNdrop,onMouseUp:this.stopDragNdrop,onDragStart:this.stop,onWheel:this.weelResizeText,coordX:this.state.posImage?this.state.posImage.x:null,coordY:this.state.posImage?this.state.posImage.y:null,indexZ:this.state.startDragNdrop,"data-imagecomponentwrapper":!0})}}]),e}(o.a.PureComponent);function It(){var t=Object(xt.a)(["\n    width: 90%;\n    height: 90%;\n    z-index: ",";\n"]);return It=function(){return t},t}function Bt(){var t=Object(xt.a)(["\n    width: 30%;\n    height: 50%;\n    position: absolute;\n    background: url(/img/media.svg);\n    border: 1px solid red;\n    padding: 40px;\n    box-sizing: border-box;\n"]);return Bt=function(){return t},t}var Mt=wt.a.div.attrs(function(t){return{style:{zIndex:t.indexZ?"9999":null,left:t.coordX?t.coordX:"45%",top:t.coordY?t.coordY:"0%",display:"flex",justifyContent:"center",alignItems:"center"}}})(Bt()),Tt=wt.a.iframe(It(),function(t){return t.zIndex?t.zIndex:"-1"}),Dt=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={targetSection:n.props.targetSection,id:n.props.id,sizeParentBox:n.props.sizeParentBox,content:n.props.path||n.props.content,shiftCoords:null,size:n.props.size?n.props.size:30,posMedia:n.props.coords.x?{x:n.props.coords.x,y:n.props.coords.y}:null,startDragNdrop:!1,istrumentsActive:!1,drawContent:!1},n.openMediaInstruments=function(t){var e={id:n.state.id,targetSection:n.state.targetSection,type:"media",zIndex:null,image:n.state.path,coords:Object(x.a)({},n.state.posMedia)};b.emit("EventInstrumentPanel",{componentStats:e,targetSection:n.state.targetSection,id:n.state.id,sizeTextValue:n.state.size}),n.setState(Object(x.a)({},n.state,{istrumentsActive:!0})),t.stopPropagation()},n.saveCoords=function(t){if(1!==t.nativeEvent.which)return!1;var e=n.refMedia.getBoundingClientRect(),a=e.left,o=e.top;e.right,e.left,e.bottom,e.top;n.setState(Object(x.a)({},n.state,{shiftCoords:{x:t.clientX-a,y:t.clientY-o},startDragNdrop:!n.state.startDragNdrop})),t.stopPropagation()},n.checkPivotPosition=function(t,e){var a=n.refMedia.getBoundingClientRect(),o=800-a.height,r=n.props.sizeParentBox.width-a.width;return e<0&&(e=0),e>o&&(e=o),t<0&&(t=0),t>r&&(t=r),{x:t,y:e}},n.delta=function(t,e){return{x:0,y:0}},n.move=function(t,e){return n.setState(Object(x.a)({},n.state,{posMedia:{x:t,y:e}}))},n.moveMedia=function(t){if(n.state.startDragNdrop&&n.state.istrumentsActive){var e=t.clientX-n.props.sizeParentBox.left,a=t.clientY-n.props.sizeParentBox.top,o=e-n.state.shiftCoords.x+n.delta().x,r=a-n.state.shiftCoords.y+n.delta().y,i=n.checkPivotPosition(o,r),c=100*i.x/n.state.sizeParentBox.width,s=100*i.y/n.state.sizeParentBox.height;n.move(c.toFixed(2)+"%",s.toFixed(2)+"%")}t.stopPropagation()},n.stopDragNdrop=function(t){n.state.startDragNdrop&&(n.setState(Object(x.a)({},n.state,{startDragNdrop:!1})),b.emit("EventUpdatePosition".concat(n.state.id),n.state.posMedia)),t.stopPropagation()},n.setContent=function(t){var e=t.urlFull;n.setState(Object(x.a)({},n.state,{path:e}))},n.weelResizeText=function(t){if(t.shiftKey&&-100===t.deltaY){var e=n.state.size+1;e=e>100?100:e,n.setState(Object(x.a)({},n.state,{size:e})),b.emit("EventupdateSize",e)}if(t.shiftKey&&100===t.deltaY){var a=n.state.size-1;a=a<=0?0:a,n.setState(Object(x.a)({},n.state,{size:a})),b.emit("EventupdateSize",a)}t.stopPropagation()},n.saveSize=function(t){if(!n.state.getSizeBool){var e=t.size;n.setState(Object(x.a)({},n.state,{getSizeBool:!0,sizeParentBox:{width:e.width,height:e.height}}))}},n.refMedia=null,n.refMediaComponent=function(t){return n.refMedia=t},n.componentDidMount=function(){b.on("EventSetContentMedia".concat(n.state.id),n.setContent),b.on("EventSaveWidth".concat(n.state.targetSection),n.saveSize)},n.componentWillUnmount=function(){b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize),b.off("EventSetContentMedia".concat(n.state.id),n.setContent)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t="https://www.youtube.com/embed/B0b59jgudto";return console.log(t),o.a.createElement(Mt,{ref:this.refMediaComponent,onClick:this.openMediaInstruments,onMouseDown:this.saveCoords,onMouseMove:this.moveMedia,onMouseLeave:this.stopDragNdrop,onMouseUp:this.stopDragNdrop,onDragStart:this.stop,onWheel:this.weelResizeText,indexZ:this.state.startDragNdrop,coordX:this.state.posMedia?this.state.posMedia.x:null,coordY:this.state.posMedia?this.state.posMedia.y:null},this.state.startDragNdrop?null:o.a.createElement(Tt,{src:this.state.startDragNdrop?null:t,drawContent:this.state.drawContent,width:this.state.width,height:this.state.height,zIndex:"0",allowfullscreen:!0},this.props.children))}}]),e}(o.a.PureComponent);function At(){var t=Object(xt.a)(["\n    width: 100%;\n    height: 100%;\n    opacity: ",";\n    border-radius: ","px;\n    pointer-events: none;\n    position: absolute;\n"]);return At=function(){return t},t}function Rt(){var t=Object(xt.a)(["\n    width: ",";\n    height: ",";\n    position: absolute;\n"]);return Rt=function(){return t},t}var Ut=wt.a.div.attrs(function(t){return{style:{zIndex:t.indexZ?"9999":null,left:t.coordX?t.coordX:"45%",top:t.coordY?t.coordY:"0%"}}})(Rt(),function(t){return t.size?t.size+"%":"30%"},function(t){return t.size?t.size+"%":"50%"}),_t=wt.a.img(At(),function(t){return t.opacity},function(t){return t.borderRadius}),Ft=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={id:n.props.id,istrumentsActive:!1,getSizeBool:!1,opacity:n.props.opacity||1,borderRadius:n.props.borderRadius||0,sizeParentBox:n.props.sizeParentBox,targetSection:n.props.targetSection,path:n.props.path,size:n.props.size?n.props.size:30,shiftCoords:null,posImage:n.props.coords.x?{x:n.props.coords.x,y:n.props.coords.y}:null,startDragNdrop:!1},n.openImageInstruments=function(t){var e={id:n.state.id,targetSection:n.state.targetSection,type:"image",borderRadius:n.state.borderRadius,opacity:n.state.opacity,zIndex:null,image:n.state.path,coords:Object(x.a)({},n.state.posImage)};b.emit("EventInstrumentPanel",{componentStats:e,targetSection:n.state.targetSection,id:n.state.id,sizeTextValue:n.state.size}),n.setState(Object(x.a)({},n.state,{istrumentsActive:!0})),t.stopPropagation()},n.saveCoords=function(t){if(1!==t.nativeEvent.which)return!1;var e=n.refImage.getBoundingClientRect(),a=e.left,o=e.top;e.right,e.left,e.bottom,e.top;n.setState(Object(x.a)({},n.state,{shiftCoords:{x:t.clientX-a,y:t.clientY-o},startDragNdrop:!n.state.startDragNdrop})),t.stopPropagation()},n.checkPivotPosition=function(t,e){var a=n.refImage.getBoundingClientRect(),o=800-a.height,r=n.props.sizeParentBox.width-a.width;return e<0&&(e=0),e>o&&(e=o),t<0&&(t=0),t>r&&(t=r),{x:t,y:e}},n.delta=function(t,e){return{x:0,y:0}},n.move=function(t,e){return n.setState(Object(x.a)({},n.state,{posImage:{x:t,y:e}}))},n.moveText=function(t){if(n.state.startDragNdrop&&n.state.istrumentsActive){var e=t.clientX-n.props.sizeParentBox.left,a=t.clientY-n.props.sizeParentBox.top,o=e-n.state.shiftCoords.x+n.delta().x,r=a-n.state.shiftCoords.y+n.delta().y,i=n.checkPivotPosition(o,r),c=100*i.x/n.state.sizeParentBox.width,s=100*i.y/n.state.sizeParentBox.height;n.move(c.toFixed(2)+"%",s.toFixed(2)+"%")}t.stopPropagation()},n.stopDragNdrop=function(t){n.state.startDragNdrop&&(n.setState(Object(x.a)({},n.state,{startDragNdrop:!1})),b.emit("EventUpdatePosition".concat(n.state.id),n.state.posImage)),t.stopPropagation()},n.setCurrentImage=function(t){var e=t.urlFull;n.setState(Object(x.a)({},n.state,{path:e}))},n.weelResizeText=function(t){if(t.shiftKey&&-100===t.deltaY){var e=n.state.size+1;e=e>100?100:e,n.setState(Object(x.a)({},n.state,{size:e})),b.emit("EventupdateSize".concat(n.state.id),e)}if(t.shiftKey&&100===t.deltaY){var a=n.state.size-1;a=a<=0?0:a,n.setState(Object(x.a)({},n.state,{size:a})),b.emit("EventupdateSize".concat(n.state.id),a)}t.stopPropagation()},n.saveSize=function(t){if(n.state.getSizeBool)b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize);else{var e=t.size;n.setState(Object(x.a)({},n.state,{getSizeBool:!0,sizeParentBox:{width:e.width,height:e.height}}))}},n.changeSizeImage=function(t){console.log(t),n.setState(Object(x.a)({},n.state,{size:t.size}))},n.setBorderRadius=function(t){var e=t.borderRadius>200||t.borderRadius;e=t.borderDown<0?0:t.borderRadius,n.setState(Object(x.a)({},n.state,{borderRadius:e}))},n.setOpacity=function(t){var e=t.opacity>1||t.opacity;e=t.opacity<0?0:t.opacity,n.setState(Object(x.a)({},n.state,{opacity:e}))},n.refImage=null,n.refImageComponent=function(t){return n.refImage=t},n.componentDidMount=function(){b.on("EventSetCurrentImage".concat(n.state.id),n.setCurrentImage),b.on("EventChangeSize".concat(n.state.id),n.changeSizeImage),b.on("EventSetOpacity".concat(n.state.id),n.setOpacity),b.on("EventSetBorderRadius".concat(n.state.id),n.setBorderRadius),b.on("EventSaveWidth".concat(n.state.targetSection),n.saveSize)},n.componentWillUnmount=function(){b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize),b.off("EventChangeSize".concat(n.state.id),n.changeSizeImage),b.off("EventSetOpacity".concat(n.state.id),n.setOpacity),b.off("EventSetBorderRadius".concat(n.state.id),n.setBorderRadius),b.off("EventSetCurrentImage".concat(n.state.id),n.setCurrentImage)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return console.log(this.state),o.a.createElement(Ut,{ref:this.refImageComponent,size:this.state.size,onClick:this.openImageInstruments,onMouseDown:this.saveCoords,onMouseMove:this.moveText,onMouseLeave:this.stopDragNdrop,onMouseUp:this.stopDragNdrop,onDragStart:this.stop,onWheel:this.weelResizeText,coordX:this.state.posImage?this.state.posImage.x:null,coordY:this.state.posImage?this.state.posImage.y:null,indexZ:this.state.startDragNdrop,"data-imagecomponentwrapper":!0},o.a.createElement(_t,{"data-imagecomponent":!0,borderRadius:this.state.borderRadius,opacity:this.state.opacity,src:this.state.path,alt:"img"}))}}]),e}(o.a.PureComponent);n(453);function Wt(){var t=Object(xt.a)(["\n    width: 100%;\n    height: 100%;\n    font-family: ",";\n    text-align: center;\n    margin: 0;\n    -moz-user-select: none;\n    -khtml-user-select: none;\n    user-select: none;\n"]);return Wt=function(){return t},t}function Lt(){var t=Object(xt.a)(["\n    position: absolute;\n    font-size: ",";\n    color: ",";\n    text-align: center;\n    margin: 0;\n    word-break: break-all;\n"]);return Lt=function(){return t},t}var Xt=wt.a.div.attrs(function(t){return{style:{zIndex:t.indexZ?"9999":null,left:t.coordX?t.coordX:"50%",top:t.coordY}}})(Lt(),function(t){return t.size},function(t){return t.textColor}),Yt=wt.a.p(Wt(),function(t){return t.font}),Vt=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={id:n.props.id,istrumentsActive:!1,isHaveSize:!1,parent:n.props.sizeParentBox,targetSection:n.props.targetSection,colorText:n.props.color,sizeText:n.props.fontSize||n.props.size,shiftCoords:null,position:n.props.coords,font:n.props.font?n.props.font:"Arial",startDragNdrop:!1,contentText:n.props.children?n.props.children:null,sectionNumber:0,getSizeBool:!1},n.openTitleInstruments=function(t){var e={id:n.state.id,targetSection:n.state.targetSection,type:"text",font:n.state.font,color:n.state.colorText,fontSize:n.state.sizeText,content:n.state.contentText,coords:Object(x.a)({},n.state.posText)};b.emit("EventInstrumentPanel",{type:"text",targetSection:n.state.targetSection,id:n.state.id,componentStats:e,sizeTextValue:n.state.sizeText}),n.setState(Object(x.a)({},n.state,{istrumentsActive:!0})),t.stopPropagation()},n.changeColorText=function(t){"string"===typeof t&&n.setState(Object(x.a)({},n.state,{colorText:t}))},n.changeSizeText=function(t){n.setState(Object(x.a)({},n.state,{sizeText:t.size}))},n.saveSize=function(t){var e=t.size;n.state.getSizeBool?b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize):n.setState(Object(x.a)({},n.state,{getSizeBool:!0,sectionNumber:t.sectionNumber+1,parent:{width:e.width,height:e.height}}))},n.changeContentText=function(t){(t.content||""===t.content)&&n.setState(Object(x.a)({},n.state,{contentText:t.content}))},n.saveCoords=function(t){if(1!==t.nativeEvent.which)return!1;var e=n.refText.getBoundingClientRect(),a=e.left,o=e.top;e.right,e.left,e.bottom,e.top;n.setState(Object(x.a)({},n.state,{shiftCoords:{x:t.clientX-a,y:t.clientY-o},startDragNdrop:!n.state.startDragNdrop})),t.stopPropagation()},n.setFont=function(t){n.setState(Object(x.a)({},n.state,{font:t.font}))},n.checkPivotPosition=function(t,e){var a=n.refText.getBoundingClientRect(),o=800-a.height,r=n.props.sizeParentBox.width-a.width;return e<0&&(e=0),e>o&&(e=o),t<0&&(t=0),t>r&&(t=r),{x:t,y:e}},n.delta=function(t,e){return{x:0,y:0}},n.move=function(t,e){return n.setState(Object(x.a)({},n.state,{position:{x:t,y:e}}))},n.moveText=function(t){if(n.state.startDragNdrop&&n.state.istrumentsActive){var e=t.clientX-n.props.sizeParentBox.left,a=t.clientY-n.props.sizeParentBox.top,o=e-n.state.shiftCoords.x+n.delta().x,r=a-n.state.shiftCoords.y+n.delta().y,i=n.checkPivotPosition(o,r),c=100*i.x/n.state.parent.width,s=100*i.y/n.state.parent.height;n.move(c.toFixed(2)+"%",s.toFixed(2)+"%")}t.stopPropagation()},n.stopDragNdrop=function(t){n.state.startDragNdrop&&(n.setState(Object(x.a)({},n.state,{startDragNdrop:!1})),b.emit("EventUpdatePosition".concat(n.state.id),n.state.position)),t.stopPropagation()},n.weelResizeText=function(t){if(t.shiftKey&&-100===t.deltaY){var e=n.state.sizeText+1;e=e>200?200:e,n.setState(Object(x.a)({},n.state,{sizeText:e})),b.emit("EventupdateSize".concat(n.state.id),e)}if(t.shiftKey&&100===t.deltaY){var a=n.state.sizeText-1;a=a<=10?10:a,n.setState(Object(x.a)({},n.state,{sizeText:a})),b.emit("EventupdateSize".concat(n.state.id),a)}t.stopPropagation()},n.refText=null,n.refTextComponent=function(t){return n.refText=t},n.componentDidMount=function(){b.on("EventChangeColorText".concat(n.state.id),n.changeColorText),b.on("EventSetFont".concat(n.state.id),n.setFont),b.on("EventChangeSize".concat(n.state.id),n.changeSizeText),b.on("EventChangeContentText".concat(n.state.id),n.changeContentText),b.on("EventSaveWidth".concat(n.state.targetSection),n.saveSize)},n.componentWillUnmount=function(){b.off("EventChangeColorText".concat(n.state.id),n.changeColorText),b.off("EventSetFont".concat(n.state.id),n.setFont),b.off("EventChangeSize".concat(n.state.id),n.changeSizeText),b.off("EventChangeContentText".concat(n.state.id),n.changeContentText),b.off("EventSaveWidth".concat(n.state.targetSection),n.saveSize)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.a.createElement(Xt,{ref:this.refTextComponent,onClick:this.openTitleInstruments,textColor:this.state.colorText?this.state.colorText:"red",size:this.state.sizeText?this.state.sizeText+"px":"120px",onMouseDown:this.saveCoords,onMouseMove:this.moveText,onMouseLeave:this.stopDragNdrop,onMouseUp:this.stopDragNdrop,onWheel:this.weelResizeText,coordX:this.state.position?this.state.position.x:null,coordY:this.state.position?this.state.position.y:null,indexZ:this.state.startDragNdrop,"data-textcomponent":!0},o.a.createElement(Yt,{font:this.state.font},this.state.contentText))}}]),e}(o.a.PureComponent);function Jt(){var t=Object(xt.a)(["\n    position: relative;\n    width: ",";\n    height: ",";\n    background-size: cover;\n    background-color: ",";\n    background-image: url(",");\n"]);return Jt=function(){return t},t}var Ht=wt.a.div(Jt(),function(t){return t.width},function(t){return t.height},function(t){return t.backgroundColor},function(t){return t.backgroundImage}),Kt=function(t){var e=Object(a.useState)(t.id),n=Object(X.a)(e,1)[0],r=Object(a.useState)(t.targetSection),i=Object(X.a)(r,1)[0],c=o.a.createRef(),s=Object(a.useState)(t.background||t.color),l=Object(X.a)(s,2),u=l[0],p=l[1],m=Object(a.useState)(t.backgroundImage?t.backgroundImage:null),d=Object(X.a)(m,2),h=d[0],g=d[1],f=Object(a.useState)(t.width?t.width:"100%"),v=Object(X.a)(f,1)[0],S=Object(a.useState)(t.height?t.height:"100%"),j=Object(X.a)(S,1)[0],E=function(t){p(t.colorRGB)},O=function(t){var e=t.urlFull;g(e)},C=function(t){console.log(t)};return Object(a.useEffect)(function(){return function(){c.current.focus();var e=c.current.getBoundingClientRect();b.emit("EventSaveWidth".concat(i),{sectionNumber:t.sectionNumber,size:{width:e.width,height:e.height}})}(),b.on("EventChangeColorBackground".concat(n),E),b.on("EventSaveSize".concat(n),C),b.on("EventSetBackgroundImage".concat(n),O),function(){b.off("EventChangeColorBackground".concat(n),E),b.off("EventSaveSize".concat(n),C),b.off("EventSetBackgroundImage".concat(n),O)}}),o.a.createElement(Ht,{ref:c,onDoubleClick:function(t){var e={id:n,targetSection:i,type:"background",color:u,backgroundImage:h};b.emit("EventInstrumentPanel",{componentStats:e,targetSection:i,type:"background",id:n}),t.stopPropagation()},"data-name":i,backgroundColor:u||t.background,backgroundImage:h||t.backgroundImage,width:v,height:j},t.children)},Zt=function(t){return"text"===t.type?o.a.createElement(Vt,{key:"text".concat(t.id),targetSection:t.targetSection,sizeParentBox:Object(x.a)({},t.sizeParentBox),id:t.id,size:t.size?t.size:t.fontSize,color:t.color,opacity:t.opacity,coords:Object(x.a)({},t.coords),font:t.font},t.content):"background"===t.type?o.a.createElement(Kt,{targetSection:t.targetSection,color:t.color,width:t.width,height:t.height,size:t.size,id:t.id,key:"bg".concat(t.id)}):"image"===t.type?o.a.createElement(Ft,{targetSection:t.targetSection,borderRadius:t.borderRadius||0,opacity:t.opacity,size:t.size?t.size:t.fontSize,path:t.path?t.path:t.image,coords:Object(x.a)({},t.coords),sizeParentBox:Object(x.a)({},t.sizeParentBox),id:t.id,key:"image".concat(t.id)}):"media"===t.type?o.a.createElement(Dt,{key:"media".concat(t.id),id:t.id,targetSection:t.targetSection,sizeParentBox:Object(x.a)({},t.sizeParentBox),path:t.path?t.path:t.content,coords:Object(x.a)({},t.coords)}):"input"===t.type?o.a.createElement(zt,{targetSection:t.targetSection,size:t.size?t.size:t.fontSize,path:t.path?t.path:t.image,coords:Object(x.a)({},t.coords),sizeParentBox:Object(x.a)({},t.sizeParentBox),id:t.id,key:"input".concat(t.id)}):void 0},Gt=(n(454),function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(r)))).state={mode:n.props.mode,componentsPatternBackground:{id:null,targetSection:null,type:"background",color:null,backgroundImage:null},componentsPatternText:{id:null,targetSection:null,type:"text",font:"Arial",color:null,opacity:1,fontSize:null,content:null,coords:{x:null,y:null}},componentsPatternImage:{id:null,targetSection:null,borderRadius:0,type:"image",opacity:1,zIndex:null,image:"/img/photoPattern.svg",coords:{x:null,y:null}},componentsPatternMedia:{id:null,targetSection:null,type:"media",size:null,content:null,coords:{x:null,y:null}},componentsPatternInput:{id:null,targetSection:null,type:"input",size:null,content:null,coords:{x:null,y:null}},sizeParentBox:Object(x.a)({},n.props.sizeParentBox),title:"Title"},n.addText=function(t){var e=Math.random().toFixed(3),a=Object(x.a)({},n.state.componentsPatternText,{id:e,targetSection:n.props.editComponentName});b.emit("EventBuildComponents",{componentsPatternText:a,type:n.state.componentsPatternText.type,component:o.a.createElement(Vt,Object.assign({key:"text".concat(e)},a,{sizeParentBox:Object(x.a)({},n.props.sizeParentBox),id:e}),"Title")}),t.stopPropagation()},n.addBackground=function(t){var e=Math.random().toFixed(3),a=Object(x.a)({},n.state.componentsPatternBackground,{targetSection:n.state.editComponentName});b.emit("EventBuildComponents",{componentsPatternBackground:a,type:n.state.componentsPatternBackground.type,component:o.a.createElement(Kt,Object.assign({targetSection:n.props.editComponentName},a,{key:"bg".concat(e),id:e}))}),t.stopPropagation()},n.addImage=function(t){var e=Math.random().toFixed(3),a=Object(x.a)({},n.state.componentsPatternImage,{id:e,targetSection:n.props.editComponentName});b.emit("EventBuildComponents",{componentsPatternImage:a,type:n.state.componentsPatternImage.type,component:o.a.createElement(Ft,Object.assign({key:"image".concat(e),sizeParentBox:n.props.sizeParentBox,id:e,path:"/img/photoPattern.svg"},a,{type:"image"}))}),t.stopPropagation()},n.addMedia=function(t){var e=Math.random().toFixed(3),a=Object(x.a)({},n.state.componentsPatternMedia,{id:e,targetSection:n.props.editComponentName});b.emit("EventBuildComponents",{componentsPatternMedia:a,type:a.type,component:o.a.createElement(Dt,Object.assign({key:"media".concat(e),targetSection:n.props.editComponentName,sizeParentBox:n.props.sizeParentBox,id:e,path:"/img/photoPattern.mp4"},a,{type:"media"}))}),t.stopPropagation()},n.addInput=function(t){var e=Math.random().toFixed(3),a=Object(x.a)({},n.state.componentsPatternInput,{id:e,targetSection:n.props.editComponentName});b.emit("EventBuildComponents",{componentsPatternInput:a,type:a.type,component:o.a.createElement(zt,Object.assign({key:"input".concat(e),targetSection:n.props.editComponentName,sizeParentBox:n.props.sizeParentBox,id:e,inputType:"button"},a,{type:"input"}))}),t.stopPropagation()},n.addSection=function(t){var e=Math.random().toFixed(3),a=Object(x.a)({},n.state.componentsPatternBackground,{targetSection:"Section".concat(e),id:"Section".concat(e),type:"background"});b.emit("EventNewSection",{componentsPatternBackground:a,component:o.a.createElement(Kt,Object.assign({},a,{key:"bg".concat(e),id:e,width:"100%",height:"800px",type:"background"}))}),t.stopPropagation()},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return"build"===this.state.mode?o.a.createElement("div",{className:"ComponentsMenu"},o.a.createElement("button",{onClick:this.addImage,className:"ImageTool CompoentnsMenu_button"},o.a.createElement("span",null,"Image")),o.a.createElement("button",{onClick:this.addText,className:"TextTool CompoentnsMenu_button"},o.a.createElement("span",null,"Text")),o.a.createElement("button",{onClick:this.addInput,disabled:"Header"===this.props.editComponentName,className:"ButtonTool CompoentnsMenu_button"},o.a.createElement("span",null,"Button")),o.a.createElement("button",{onClick:this.addMedia,className:"VideoTool CompoentnsMenu_button"},o.a.createElement("span",null,"Video"))):"section"===this.state.mode?o.a.createElement("div",{className:"sectionMode"},o.a.createElement("button",{onClick:this.addSection,className:"newSectionTool CompoentnsMenu_button"},o.a.createElement("span",null,"New section"))):void 0}}]),e}(o.a.PureComponent)),qt=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={viewComponentMenu:!1,editComponentName:n.props.editComponentName,shiftX:0,shiftY:0,coordsX:"50%",coordsY:"0",shadowDisplay:"block"},n.componentMenu=function(t){n.setState({viewComponentMenu:!n.state.viewComponentMenu}),t.stopPropagation()},n.componentDidUpdate=function(){n.props.editComponentName!==n.state.editComponentName&&n.setState(Object(x.a)({},n.state,{editComponentName:n.props.editComponentName}))},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.a.createElement(a.Fragment,null,o.a.createElement("div",{ref:this.refControll,className:"ControllersEditComponent",onClick:this.componentMenu},o.a.createElement(Z,{onClick:this.componentMenu,className:"addButton",path:"/img/addButton.png"}),this.state.viewComponentMenu?o.a.createElement(Gt,{key:"buildMenu ".concat(this.state.editComponentName),mode:"build",editComponentName:this.state.editComponentName,sizeParentBox:this.props.sizeParentBox,countComponents:this.props.countComponents}):null))}}]),e}(o.a.PureComponent),$t=(n(455),function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={targetSection:n.props.id,editRedy:!1,component:null,children:null},n.changeMode=function(){n.state.editStart&&n.state.idProject===n.props.editComponentName||n.setState(Object(x.a)({},n.state,{editStart:!0}),function(){return b.emit("EventModeEdit",Object(x.a)({},n.state,{editStart:!0,targetSection:n.state.targetSection}))})},n.refSection=null,n.refSectionFunc=function(t){return t?n.refSection={data:t.getBoundingClientRect(),node:t}:t},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this,e=this.props.currentProjectsData.components.find(function(e){return e.targetSection===t.props.id})||null,n=this.props.mainBuilderData.componentJSX.filter(function(e){return e.targetSection===t.props.id});return e?o.a.createElement(a.Fragment,null,o.a.createElement("section",{className:"element".concat(this.props.sectionNumber),ref:this.refSectionFunc,"data-class":"editable",onClick:this.changeMode},o.a.createElement(Kt,Object.assign({},e,{sectionNumber:this.props.sectionNumber}),n.map(function(t){return t.component})||null),!this.state.editStart&&o.a.createElement("div",{className:"warningEdit"},o.a.createElement("p",null,"Click for start edit")))):o.a.createElement(Y,null)}}]),e}(o.a.PureComponent)),Qt=function(t){var e=t.userData.currentProjectsData;return e.sectionTitleProject.map(function(n,a){return o.a.createElement($t,{key:n,mainBuilderData:Object(x.a)({},t.mainBuilderData),currentProjectsData:Object(x.a)({},e),editComponentName:t.editComponentName,countComponents:t.mainBuilderData.componentJSX.length,menuActive:t.menuActive,sizeParentBox:t.sizeParentBox,id:n,sectionNumber:a},{targetSection:t.editComponentName})})},te=(n(456),function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(r)))).state={idProject:parseInt(n.props.match.params.param),editStart:!1,position:0,isLoadComponents:!0,projectEmpty:!1,componentStats:{},mainBuilderData:{components:[],componentJSX:[]},instrumentPanel:{colorPickerActive:!1,instrumentActive:!1},scrollConfig:{duration:1e3,delay:50,smooth:!0,offset:-80},editComponentName:null,menuActive:!1,modalSearch:!1,modalSearchMode:null,modalImageViewer:{action:!1,image:null},sizeParentBox:null},n.modalSearchOn=function(t){var e=t.hasOwnProperty("mode");n.setState(Object(x.a)({},n.state,{modalSearch:!n.state.modalSearch,modalSearchMode:e?t.mode:null}))},n.imageViewerSwitch=function(t){n.setState(Object(x.a)({},n.state,{modalImageViewer:Object(x.a)({},n.state.modalImageViewer,{action:t.action,target:t.target})}))},n.workModeEdit=function(t){t.editStart&&n.setState(Object(x.a)({},n.state,{editStart:t.editStart,editComponentName:t.targetSection,mainBuilderData:Object(x.a)({},n.state.mainBuilderData),menuActive:!0}))},n.openInstrument=function(t){n.state.componentStats.id===t.componentStats.id||n.setState(Object(x.a)({},n.state,{editComponentName:t.targetSection,componentStats:Object(x.a)({},n.state.componentStats,t.componentStats),instrumentPanel:Object(x.a)({},n.state.instrumentPanel,{instrumentActive:!0})}))},n.closePanel=function(t){n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel,{colorPickerActive:!1,instrumentActive:t.close})}))},n.addComponentsFromBD=function(t){var e=n.state.mainBuilderData.componentJSX,a=[],r=Object(y.a)(n.state.mainBuilderData.components);t.forEach(function(t){if("background"!==t.type){var e={width:n.mainComponent.data.width,height:n.mainComponent.data.height,top:n.mainComponent.data.top,left:n.mainComponent.data.left},i=o.a.createElement(Zt,Object.assign({sizeParentBox:Object(x.a)({},e)},t,{key:"".concat(t.type).concat(t.id)})),c={id:t.id,targetSection:t.targetSection,component:i};a.push(c),r.push(t)}else r.push(t)}),n.setState(Object(x.a)({},n.state,{isLoadComponents:!1,mainBuilderData:Object(x.a)({},n.state.mainBuilderData,{components:[].concat(Object(y.a)(n.state.mainBuilderData.components),Object(y.a)(r)),componentJSX:[].concat(Object(y.a)(e),a)})}))},n.addComponent=function(t){var e=n.state.mainBuilderData.componentJSX,a=null;"text"===t.type?a=t.componentsPatternText:"background"===t.type?a=t.componentsPatternBackground:"image"===t.type?a=t.componentsPatternImage:"media"===t.type?a=t.componentsPatternMedia:"input"===t.type&&(a=t.componentsPatternInput);var o={id:a.id,targetSection:a.targetSection,component:t.component};n.setState(Object(x.a)({},n.state,{mainBuilderData:Object(x.a)({},n.state.mainBuilderData,{components:[].concat(Object(y.a)(n.state.mainBuilderData.components),[a]),componentJSX:[].concat(Object(y.a)(e),[o])})}))},n.saveChangesComponent=function(t){var e=n.props.userData,a=!1,o=n.state.mainBuilderData.components.map(function(e){return e.id===t.id?(a=!0,Object(x.a)({},t)):e});a||o.push(t),n.setState(Object(x.a)({},n.state,{mainBuilderData:Object(x.a)({},n.state.mainBuilderData,{isChange:!1,components:o})}),function(){var t=n.props.userData.currentProjectsData;return n.props.dispatch(bt({uid:e.idUser,projects:Object(y.a)(e.projects),components:Object(y.a)(n.state.mainBuilderData.components),sectionTitleProject:Object(y.a)(t.sectionTitleProject),idProject:n.state.idProject}))})},n.mainComponent=null,n.mainRefComponent=function(t){return t?n.mainComponent={data:t.getBoundingClientRect(),node:t}:t},n.addNewSection=function(t){var e=n.props.userData;n.setState(Object(x.a)({},n.state,{mainBuilderData:Object(x.a)({},n.state.mainBuilderData,{components:[].concat(Object(y.a)(n.state.mainBuilderData.components),[t.componentsPatternBackground]),componentJSX:[].concat(Object(y.a)(n.state.mainBuilderData.componentJSX),[t.component])})}),function(){return n.props.dispatch(bt({uid:e.idUser,projects:Object(y.a)(e.projects),components:Object(y.a)(n.state.mainBuilderData.components),sectionTitleProject:[].concat(Object(y.a)(n.props.userData.currentProjectsData.sectionTitleProject),[t.componentsPatternBackground.id]),idProject:n.state.idProject}))})},n.moveLocation=function(t){if(console.log(n.mainComponent.node.scrollTop),!n.state.modalSearch){var e=n.props.userData.currentProjectsData.sectionTitleProject.length-1,a=n.state.position<e&&t.deltaY>0,o=t.deltaY<0&&n.state.position>0,r={width:n.mainComponent.data.width,height:n.mainComponent.data.height,top:n.mainComponent.data.top,left:n.mainComponent.data.left};a?n.setState(Object(x.a)({},n.state,{position:n.state.position+1,sizeParentBox:r}),function(){return ft.scroller.scrollTo("element".concat(n.state.position),n.state.scrollConfig)}):o&&(1===n.state.position?n.setState(Object(x.a)({},n.state,{position:n.state.position-1,sizeParentBox:r}),function(){return ft.animateScroll.scrollToTop()}):n.setState(Object(x.a)({},n.state,{position:n.state.position-1,sizeParentBox:r}),function(){return ft.scroller.scrollTo("element".concat(n.state.position),n.state.scrollConfig)}))}},n.componentDidUpdate=function(){var t=n.props.userData,e=t.currentProjectsData,a=n.state.isLoadComponents,o=null;if(n.mainComponent&&null===n.state.sizeParentBox&&(o={width:n.mainComponent.data.width,height:n.mainComponent.data.height,top:n.mainComponent.data.top,left:n.mainComponent.data.left}),t.active&&!e.loadProject){var r=t.projects.find(function(t){return t.id===n.state.idProject});r?n.props.dispatch(k({id:r.id,typeProject:r.type,sectionTitleProject:Object(y.a)(r.sectionTitleProject),components:Object(y.a)(r.components)})):n.setState(Object(x.a)({},n.state,{projectEmpty:!0,sizeParentBox:o}))}e.loadProject&&a&&(null===n.state.sizeParentBox&&null!==o?n.setState(Object(x.a)({},n.state,{sizeParentBox:o}),function(){return n.addComponentsFromBD(Object(y.a)(e.components))}):n.addComponentsFromBD(Object(y.a)(e.components)))},n.componentDidMount=function(){var t=n.props.userData,e=t.currentProjectsData;if(t.active&&!e.loadProject){var a=t.projects.find(function(t){return t.id===n.state.idProject});n.props.dispatch(k({id:a.id,sectionTitleProject:Object(y.a)(a.sectionTitleProject),typeProject:a.type,components:Object(y.a)(a.components)}))}b.on("EventBuildComponents",n.addComponent),b.on("EventNewSection",n.addNewSection),b.on("EventSaveChangesComponent",n.saveChangesComponent),b.on("EventClosePanel",n.closePanel),b.on("EventModalSearchOn",n.modalSearchOn),b.on("EventInstrumentPanel",n.openInstrument),b.on("EventImageView",n.imageViewerSwitch),b.on("EventModeEdit",n.workModeEdit)},n.componentWillUnmount=function(){n.props.userData.active&&n.props.dispatch(w(!0)),b.off("EventBuildComponents",n.addComponent),b.off("EventNewSection",n.addNewSection),b.off("EventSaveChangesComponent",n.saveChangesComponent),b.off("EventModalSearchOn",n.modalSearchOn),b.off("EventClosePanel",n.closePanel),b.off("EventInstrumentPanel",n.openInstrument),b.off("EventImageView",n.imageViewerSwitch),b.off("EventModeEdit",n.workModeEdit)},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){if(this.state.projectEmpty)return o.a.createElement(v.a,{to:"/Cabinet"});var t=this.state.instrumentPanel.instrumentActive,e=this.props.userData,n=e.currentProjectsData,r=n.sectionTitleProject;return e.active&&n.loadProject?o.a.createElement(a.Fragment,null,o.a.createElement(Q,{key:"Header",title:"Constructor"}),o.a.createElement("div",{ref:this.mainRefComponent,onWheel:this.moveLocation,onMouseMove:this.showAddSection,className:"Build",key:"Build"},this.state.editStart&&o.a.createElement(qt,{key:"controllers",editComponentName:this.state.editComponentName,countComponents:this.state.mainBuilderData.components.length,menuActive:this.state.menuActive,sizeParentBox:this.state.sizeParentBox}),o.a.createElement(Gt,{key:"buildMenu",countSection:5*this.state.mainBuilderData.componentJSX.length,mode:"section",className:"menu"}),t&&o.a.createElement(yt,Object.assign({key:"tools"},this.state)),r.length&&o.a.createElement(Qt,Object.assign({key:"section"},this.state,{userData:e})))):this.props.firebase.getCurrentUser()?o.a.createElement(Y,{key:"Loader",path:"/img/loading.gif",type:"build"}):o.a.createElement(v.a,{to:"/"})}}]),e}(o.a.PureComponent)),ee=Object(O.b)(function(t){return{userData:{active:t.cabinet.active,idUser:t.cabinet.idUser,projects:Object(y.a)(t.cabinet.projects),currentProjectsData:Object(x.a)({},t.builder)}}})(L(te)),ne=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(t=Object(g.a)(e)).call.apply(t,[this].concat(o)))).state={firebase:n.props.firebase,firebaseLoadState:!1},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.props.firebase.auth.onAuthStateChanged(function(e){var n;t.state.firebaseLoadState||(e&&t.props.dispatch((n=e.uid,function(){var t=Object(U.a)(R.a.mark(function t(e,a,o){var r;return R.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.firebase,t.next=3,r.db.collection("users").doc(n).get().then(function(t){var a=t.data();e(N({uid:n,projects:Object(y.a)(a.projects)}))}).catch(function(t){console.error(t.message),e(z(t.message))});case 3:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}())),t.setState(Object(x.a)({},t.state,{firebaseLoadState:!0})))})}},{key:"render",value:function(){var t=this;return this.state.firebaseLoadState?o.a.createElement("div",null,o.a.createElement(v.d,null,o.a.createElement(v.b,{path:"/",exact:!0,render:function(t){return o.a.createElement(H,t)}}),o.a.createElement(v.b,{path:"/Cabinet/",exact:!0,component:mt}),o.a.createElement(v.b,{path:"/Cabinet/About",render:function(e){return o.a.createElement(gt,Object.assign({},e,{config:t.props.config}))}}),o.a.createElement(v.b,{path:"/Cabinet/Build/:param",component:ee}),o.a.createElement(v.b,{path:"/Cabinet/Production/:param",component:ht}),o.a.createElement(v.b,{path:"*",component:H}),o.a.createElement(v.b,{path:"/crashPage",component:S}))):o.a.createElement(Y,{path:"/img/loading.gif",type:"application"})}}]),e}(o.a.PureComponent),ae=Object(O.b)()(L(ne));n(457);d.saveSession("SESSION");var oe=n(104);i.a.render(o.a.createElement(E.a,null,o.a.createElement(j,null,o.a.createElement(W.Provider,{value:d},o.a.createElement(O.a,{store:D},o.a.createElement(ae,{config:oe}))))),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/constructor",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/constructor","/service-worker.js");c?(function(t,e){fetch(t).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):s(t,e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e,t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker.")})):s(e,t)})}}()}},[[191,1,2]]]);
//# sourceMappingURL=main.71991215.chunk.js.map