(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{182:function(e,t,n){e.exports=n(439)},254:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},271:function(e,t,n){},434:function(e,t,n){},435:function(e,t,n){},436:function(e,t,n){},437:function(e,t,n){},439:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(86),c=n.n(r),i=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var l=n(6),u=n(7),p=n(61),m={apiKey:"AIzaSyBrLv9RyGWXCeEETRqBbBo3EVOcibmnJwU",authDomain:"constructor-acb61.firebaseapp.com",databaseURL:"https://constructor-acb61.firebaseio.com",projectId:"constructor-acb61",storageBucket:"",messagingSenderId:"654914699801",appId:"1:654914699801:web:245a75eea5c628d5"},d=(n(248),n(250),new(function(){function e(t){Object(l.a)(this,e),p.initializeApp(t),this.auth=p.auth(),this.db=p.firestore()}return Object(u.a)(e,[{key:"saveSession",value:function(e){return this.auth.setPersistence(p.auth.Auth.Persistence[e])}},{key:"login",value:function(e,t){try{return this.auth.signInWithEmailAndPassword(e,t)}catch(n){return console.error(n),null}}},{key:"registration",value:function(e,t){return this.auth.createUserWithEmailAndPassword(e,t)}},{key:"signOut",value:function(){return this.auth.signOut()}},{key:"getCurrentUser",value:function(){return this.auth.currentUser}}]),e}())(m)),h=n(9),b=n(8),f=n(10),g=new(n(171).EventEmitter),v=n(41),j=(n(254),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={redirect:!1},n.update=function(e){n.setState({redirect:!0},function(){return g.emit("EventErrorCatchUpdate")})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.redirect?o.a.createElement(v.a,{to:"/"}):o.a.createElement("div",{class:"container"},o.a.createElement("div",{class:"flex-column"},o.a.createElement("h1",null,"Application crash"),o.a.createElement("button",{className:"button_updateApp",onClick:this.update},"Update")))}}]),t}(o.a.Component)),E=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={hasError:!1},n.updateApplication=function(e){n.setState({hasError:!1})},n.componentDidMount=function(){g.on("EventErrorCatchUpdate",n.updateApplication)},n.componentWillUnmount=function(){g.off("EventErrorCatchUpdate",n.updateApplication)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidCatch",value:function(e,t){console.error(e+","+t)}},{key:"render",value:function(){return this.state.hasError?o.a.createElement(j,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.log(e),{hasError:!0}}}]),t}(o.a.PureComponent),O=n(29),C=n(18),P=n(38),w=n(174),S=n.n(w),y=n(175),k=n(5),x=n(1),N=function(e){return{type:"EXIT_PROJECT",exit:e}},I=function(e){return{type:"LOAD_CURRENT",id:e.id,typeProject:e.typeProject,components:e.components}},B=function(e){return{type:"LOAD_USER_CABINET",active:!0,idUser:e.uid,error:"",projects:e.projects}},A=function(e){return{type:"ERROR_CABINET",error:e}},M={loadProject:!1,haveUpdateLoading:!0,idProject:null,typeProject:null,components:[]},U={active:!1,idUser:null,projects:[],error:null},D=Object(P.c)({builder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_CURRENT":return Object(x.a)({},e,{haveUpdateLoading:!e.haveUpdateLoading,loadProject:!0,idProject:t.id,typeProject:t.typeProject,components:Object(k.a)(t.components)});case"LOAD_UPDATE_PROJECT":return Object(x.a)({},e,{haveUpdateLoading:!1,components:Object(k.a)(t.components)});case"EXIT_PROJECT":return t.exit?Object(x.a)({},e,{haveUpdateLoading:!0,loadProject:!1,idProject:null,typeProject:null,components:[]}):e;default:return e}},cabinet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_USER_CABINET":return Object(x.a)({},e,{active:t.active,idUser:t.idUser,projects:Object(k.a)(t.projects)});case"CREATE_PROJECT":return Object(x.a)({},e,{projects:Object(k.a)(t.projects)});case"LOAD_UPDATE_PROJECT":return Object(x.a)({},e,{projects:e.projects.map(function(e){return e.id===t.idProject&&(e.components=Object(k.a)(t.components)),e})});case"LOG_OUT_CABINET":return Object(x.a)({},e,{active:!1,idUser:null,projects:[]});case"ERROR_CABINET":return Object(x.a)({},e,{error:t.error});default:return e}}});var T=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):P.d)(Object(P.a)(y.a.withExtraArgument({firebase:d})),Object(P.a)(S()(function(e,t,n,a){console.error(e),console.debug("current state",t()),console.debug("last action was",n)}))),R=Object(P.e)(D,T),_=n(15),z=n.n(_),L=n(34),W=function(e,t){return function(){var n=Object(L.a)(z.a.mark(function n(a,o,r){var c;return z.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c=r.firebase,n.next=3,c.login(e,t).then(function(e){c.db.collection("users").doc(e.user.uid).get().then(function(e){var t=e.data();a(B({uid:e.id,projects:Object(k.a)(t.projects)}))})}).catch(function(e){console.error(e.message),a(A(e.message))});case 3:case"end":return n.stop()}},n)}));return function(e,t,a){return n.apply(this,arguments)}}()},X=function(e){return function(){var e=Object(L.a)(z.a.mark(function e(t,n,a){var o;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.firebase,e.next=3,o.signOut().then(function(e){t({type:"LOG_OUT_CABINET",active:!1,idUser:null,error:"",projects:[]})}).catch(function(e){console.error(e.message),t(A(e.message))});case 3:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},V=function(e){return function(t){return o.a.createElement(e,Object.assign({firebase:d},t))}},F=n(4),J=function(e){var t=Object(a.useState)(e.path),n=Object(F.a)(t,1)[0];return o.a.createElement("div",{className:"loaderBox"},o.a.createElement("img",{className:"loader",src:n,alt:"loader"}),o.a.createElement("p",null,"Loading ",e.type))},Y=(n(261),V(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={firebase:n.props.firebase,error:null},n.emailRef=null,n.passwordRef=null,n.setRefEmail=function(e){return n.emailRef=e},n.setRefPassword=function(e){return n.passwordRef=e},n.createUser=function(e){var t=n.emailRef?n.emailRef.value:null,a=n.passwordRef?n.passwordRef.value:null,o=n.props.firebase;if(!a||!t)return n.setState({error:"invalid user data"});o.registration(t,a).then(function(e){if(!e)throw new Error("Ivaid registration");o.db.collection("users").doc(e.user.uid).set({projects:[],email:t}).then(function(){return g.emit("EventRegistrationCorrect",e)})}).catch(function(e){console.error(e.message),n.setState({error:e.message})})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.error;return o.a.createElement("div",{className:"RegistrationBox"},o.a.createElement("div",{className:"RegistrationForm"},o.a.createElement("h3",null,"Registration"),o.a.createElement("form",{autoComplete:"off",className:"RegForm"},e?o.a.createElement("p",{className:"error"},e):null,o.a.createElement("span",null,"E-mail"),o.a.createElement("input",{ref:this.setRefEmail,type:"text"}),o.a.createElement("span",null,"Password"),o.a.createElement("input",{className:"password",autoComplete:"off",ref:this.setRefPassword,type:"password"}),o.a.createElement("input",{onClick:this.createUser,className:"loginButton",type:"button",value:"registration"}))))}}]),t}(o.a.PureComponent))),H=(n(262),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={title:"Constructor",registrationActive:!1,regStatus:!1,wrongEnter:!1,error:""},n.emailImput=null,n.passwordImput=null,n.statusRegistration=function(e){e.additionalUserInfo.isNewUser?n.setState(Object(x.a)({},n.state,{regStatus:!0,registrationActive:!1,error:"Account create!"})):console.error("error registration"),e.stopPropagation()},n.showBox=function(e){n.setState(Object(x.a)({},n.state,{registrationActive:!n.state.registrationActive})),e.stopPropagation()},n.authTo=function(e){n.emailImput,n.passwordImput&&n.props.dispatch(W(n.emailImput.value,n.passwordImput.value)),e.stopPropagation()},n.emailRef=function(e){return n.emailImput=e},n.passwordRef=function(e){return n.passwordImput=e},n.componentDidMount=function(e){g.on("EventRegistrationCorrect",n.statusRegistration)},n.componentWillUnmount=function(e){g.off("EventRegistrationCorrect",n.statusRegistration)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.active?o.a.createElement(v.a,{to:"/Cabinet"}):this.props.active?o.a.createElement(J,{path:"/img/loading.gif",type:"session"}):o.a.createElement("div",{className:"LoginPage flex-column"},o.a.createElement("h1",null,this.state.title),o.a.createElement("div",{className:"LoginBox"},o.a.createElement("div",{className:"LoginForm"},o.a.createElement("h3",null,"Connect form"),this.props.wrongEnter||this.state.regStatus?o.a.createElement("p",{className:"error"},this.props.wrongEnter):null,o.a.createElement("p",null,"E-mail"),o.a.createElement("input",{ref:this.emailRef,type:"text"}),o.a.createElement("p",null,"Password"),o.a.createElement("input",{ref:this.passwordRef,type:"password"}),o.a.createElement("input",{onClick:this.authTo,className:"loginButton enterInput",type:"button",value:"enter"}),o.a.createElement("input",{onClick:this.showBox,className:this.state.registrationActive?"loginButton registration selected":"loginButton registration",type:"button",value:"registration"}))),this.state.registrationActive?o.a.createElement(Y,null):null)}}]),t}(o.a.PureComponent)),G=Object(C.b)(function(e){return{active:e.cabinet.active,wrongEnter:e.cabinet.error}})(H),q=function(e){return function(){var t=Object(L.a)(z.a.mark(function t(n,a,o){var r;return z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.firebase,t.next=3,r.db.collection("users").doc(e.uid).get().then(function(e){return e.data()}).then(function(t){return{id:t.id,projects:t.projects.filter(function(t){return t.id!==e.id})}}).then(function(t){r.db.collection("users").doc(e.uid).update({projects:t.projects}).then(function(e){n(B({uid:t.id,projects:t.projects}))})}).catch(function(e){console.error(e.message),n(A(e.message))});case 3:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}()};n(263);var K=function(e){var t=Object(a.useState)(e.path),n=Object(F.a)(t,1)[0],r=Object(a.useState)(e.className?e.className:null),c=Object(F.a)(r,1)[0],i=Object(a.useState)(!!e.draggable),s=Object(F.a)(i,1)[0];return o.a.createElement("img",{draggable:s,onClick:e.onClick?e.onClick:null,className:c,title:e.title?e.title:null,src:"/constructor"+n,alt:"icon"})},$=n(99).CabinetIcon,Q=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={title:n.props.title,redirectAbout:{path:"/Cabinet/About",redirectA:!1},redirectCabinet:{path:"/Cabinet",redirectC:!1}},n.logOut=function(e){n.props.idUser&&n.props.dispatch(X(n.props.idUser)),e.stopPropagation()},n.redirectAbout=function(e){n.props.location.pathname!==n.state.redirectAbout.path&&n.setState({redirectAbout:Object(x.a)({},n.state.redirectAbout,{redirectA:!0})}),e.stopPropagation()},n.redirectCabinet=function(e){n.props.location.pathname!==n.state.redirectCabinet.path&&n.setState({redirectCabinet:Object(x.a)({},n.state.redirectCabinet,{redirectC:!0})}),e.stopPropagation()},n.add=function(e){g.emit("EventChangeWorkMode",{action:"newProject"})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.redirectAbout.redirectA,t=this.state.redirectCabinet.redirectC;return e?o.a.createElement(v.a,{to:this.state.redirectAbout.path}):t?o.a.createElement(v.a,{to:this.state.redirectCabinet.path}):o.a.createElement("header",null,o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"flex-row"},o.a.createElement("div",{onClick:this.redirectCabinet,className:"header__CabinetInfo"},o.a.createElement(K,{className:"mainIcon",path:$}),o.a.createElement("h3",{className:"tilteApp"},this.state.title)),"/Cabinet"===this.props.location.pathname?o.a.createElement("div",{onClick:this.add,className:"header__newProject__AddButton"},o.a.createElement(K,{className:"Cabinet",path:"/img/plus.png"})):null,o.a.createElement("div",{className:"Navigator"},o.a.createElement(K,{className:"about",onClick:this.redirectAbout,title:"about",path:"/img/about_logo.svg"}),o.a.createElement(K,{className:"logoutButton",onClick:this.logOut,title:"logOut",path:"/img/logOut.svg"})))))}}]),t}(o.a.Component),Z=Object(C.b)()(Object(v.g)(Q)),ee=n(60),te=n(176),ne=n.n(te),ae=function(e){var t=Object(a.useState)(e.id),n=Object(F.a)(t,1)[0],r=Object(a.useState)(e.urls.regular),c=Object(F.a)(r,1)[0],i=Object(a.useState)(e.urls.full),s=Object(F.a)(i,1)[0],l=Object(a.useState)(e.isFull),u=Object(F.a)(l,1)[0];return o.a.createElement("div",{className:e.selected?"ItemBox selected":"ItemBox"},o.a.createElement("img",{className:"ImageItem",onClick:function(e){g.emit("EventShowMenuImage",{id:n,url:c,urlFull:s})},src:u?s:c,alt:"item"}))},oe=(n(265),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={workMode:n.props.workMode,images:{buttonSearchDisabled:!1,selectedItem:null,showUrl:null,images:null,urlFull:null,imageBoxView:!1,error:""},newProject:{validateName:!1,validateType:!1,disabled:!0,name:"",type:"empty"},imageMenuActive:!1,warning:{lengthMax:"Max length: 20 symbols",lengthMin:"Min length: 4 symbol",type:"Select type of webpage"}},n.inputSearch=null,n.inputSelect=null,n.searchBackground=function(e){var t="https://api.unsplash.com/".concat("search/photos/?page=1&per_page=40&query="),a=n.inputSearch.value;n.setState(Object(x.a)({},n.state,{images:Object(x.a)({},n.state.inages,{buttonSearchDisabled:!0})})),ne()("".concat(t+a,"&client_id=").concat("421b12ae729e1f6e4a0cac207496874099ab8a738378ec07a8e2598b11201802")).then(function(e){if(e.ok)return e.json();throw new Error("request invalid")}).then(function(e){var t=e.results;if(!t.length)throw new Error("Photos not found");n.setState(Object(x.a)({},n.state,{images:Object(x.a)({},n.state.images,{imageBoxView:!0,error:"",images:Object(k.a)(t),buttonSearchDisabled:!1})}))}).catch(function(e){console.error(e.message),n.setState(Object(x.a)({},n.state,{images:Object(x.a)({},n.state.images,{error:e.message}),imageBoxView:!1,buttonSearchDisabled:!1}))})},n.showMenuImage=function(e){n.setState(Object(x.a)({},n.state,{imageMenuActive:!0,images:Object(x.a)({},n.state.images,{selectedItem:e.id,showUrl:e.url,urlFull:e.urlFull})}))},n.showImage=function(e){var t=n.state.images.showUrl;g.emit("EventImageView",{action:!0,target:t||null}),e.stopPropagation()},n.setSelectedImage=function(e){var t=Object(x.a)({},n.state.images);g.emit("EventSetBackgroundImage".concat(n.props.idComponent),t),g.emit("EventSetBImageInstumentPanel",t),e.stopPropagation()},n.makeImageResultBox=function(e){return e?e.map(function(e,t){return o.a.createElement(ae,{key:"item".concat(t),id:t,selected:n.state.images.selectedItem===t,isFull:!1,urls:Object(x.a)({},e.urls)})}):null},n.addNewProject=function(e){var t=n.state[n.state.workMode];t.validateType&&t.validateName&&(g.emit("EventAddProject",{title:n.state[n.state.workMode].name,type:n.state[n.state.workMode].type}),g.emit("EventChangeWorkMode",{action:"default"}))},n.selectOption=function(e){var t=Object(x.a)({},n.state[n.state.workMode]);t.type=e.target.value,t.validateType="empty"!==t.type,t.disabled=!t.validateType||!t.validateName,n.setState(Object(x.a)({},n.state,Object(ee.a)({},n.state.workMode,t)))},n.validateName=function(e){var t=Object(x.a)({},n.state[n.state.workMode]);t.name=e.target.value;var a=t.name.length;t.validateName=a>=4&&a<20,t.disabled=!t.validateType||!t.validateName,n.setState(Object(x.a)({},n.state,Object(ee.a)({},n.state.workMode,t)))},n.cancel=function(e){"Search"===n.state.workMode?g.emit("EventModalSearchOn"):g.emit("EventChangeWorkMode",{action:"default"})},n.refSelect=function(e){return n.inputSelect=e},n.refSearch=function(e){return n.inputSearch=e},n.componentDidMount=function(e){"Search"===n.state.workMode&&g.on("EventShowMenuImage",n.showMenuImage)},n.componentWillUnmount=function(e){"Search"===n.state.workMode&&g.off("EventShowMenuImage",n.showMenuImage)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){switch(this.state.workMode){case"newProject":return o.a.createElement("div",{className:"Modal"},o.a.createElement("h3",null,"Create new Project"),this.state[this.state.workMode].name.length<=3?o.a.createElement("span",{className:"warning"},this.state.warning.lengthMin):null,this.state[this.state.workMode].name.length>=20?o.a.createElement("span",{className:"warning"},this.state.warning.lengthMax):null,o.a.createElement("input",{className:this.state[this.state.workMode].validateName?"ready":"wrong",value:this.state[this.state.workMode].name,onChange:this.validateName,type:"text",placeholder:"Project name"}),this.state[this.state.workMode].validateType?null:o.a.createElement("span",{className:"warning"},this.state.warning.type),o.a.createElement("select",{onChange:this.selectOption},o.a.createElement("option",{value:"empty"},"--------"),o.a.createElement("option",{value:"landing"},"Landing"),o.a.createElement("option",{value:"portfolio"},"Portfolio")),o.a.createElement("input",{onClick:this.addNewProject,className:"acceptButton",disabled:this.state[this.state.workMode].disabled,type:"button",value:"Submit"}),o.a.createElement("input",{onClick:this.cancel,type:"button",value:"Cancel"}));case"Search":return o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:"Modal Modal-search"},o.a.createElement("h3",null,"Search background image"),this.state.images.error?o.a.createElement("span",{className:"error"},this.state.images.error):null,o.a.createElement("input",{ref:this.refSearch,type:"text",placeholder:"Photo name"}),o.a.createElement("input",{disabled:this.state.images.buttonSearchDisabled,className:"acceptButton",type:"button",value:"Search",onClick:this.searchBackground}),o.a.createElement("input",{onClick:this.cancel,type:"button",value:"Cancel"}),this.state.images.imageBoxView?o.a.createElement("div",{className:"searchResultBox"},this.makeImageResultBox(Object(k.a)(this.state.images.images))):null),this.state.imageMenuActive?o.a.createElement("div",{className:"ActionModalSearch"},o.a.createElement("button",{onClick:this.showImage,className:"actionModalSearch__view"},o.a.createElement(K,{path:"/img/view.png"})),o.a.createElement("button",{onClick:this.setSelectedImage,className:"actionModalSearch__settings"},o.a.createElement(K,{path:"/img/settings.png"}))):null);default:return o.a.createElement(a.Fragment,null)}}}]),t}(o.a.PureComponent)),re=function(e,t,n,a){return function(){var o=Object(L.a)(z.a.mark(function o(r,c,i){var s,l,u;return z.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=i.firebase,l=Object(k.a)(t),u=l.length?l[l.length-1].id+1:0,l.push({id:u,title:n,type:a,components:[]}),o.next=6,s.db.collection("users").doc(e).update({projects:l}).then(function(){return r({type:"CREATE_PROJECT",projects:l})}).catch(function(e){console.error(e.message),r(A(e.message))});case 6:case"end":return o.stop()}},o)}));return function(e,t,n){return o.apply(this,arguments)}}()};n(266);var ce=Object(v.g)(function(e){var t=Object(a.useState)("/Cabinet/Build/".concat(e.id)),n=Object(F.a)(t,1)[0],r=Object(a.useState)(!1),c=Object(F.a)(r,2),i=c[0],s=c[1],l=Object(a.useState)(e.id),u=Object(F.a)(l,1)[0],p=Object(a.useState)(e.name),m=Object(F.a)(p,1)[0],d=Object(a.useState)(e.type),h=Object(F.a)(d,1)[0];return i?o.a.createElement(v.a,{to:n}):o.a.createElement("div",{className:"item","data-id":u},o.a.createElement("p",{className:"ProjectName"},m),o.a.createElement("p",{className:"ProjectType"},h),o.a.createElement("div",{className:"projectController"},o.a.createElement("input",{onClick:function(t){e.location.pathname!==n&&s(!0),t.stopPropagation()},className:"projectControllerButton_enter",type:"button",value:"enter build"}),o.a.createElement("input",{onClick:function(t){g.emit("EventDeleteItem",{id:e.id,name:e.name,type:e.type}),t.stopPropagation()},className:"projectControllerButton_delete",type:"button",value:"delete"})))}),ie=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={redirect:!1},n.addNewProject=function(e){n.props.idUser?n.props.dispatch(re(n.props.idUser,n.props.list,e.title,e.type)):n.setState(Object(x.a)({},n.state,{redirect:!0}))},n.makeList=function(e){return e.map(function(e){return o.a.createElement(ce,{key:e.id,id:e.id,name:e.title,type:e.type})})},n.componentDidMount=function(){g.on("EventAddProject",n.addNewProject)},n.componentWillUnmount=function(){g.off("EventAddProject",n.addNewProject)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.redirect?o.a.createElement(v.a,{to:"/"}):o.a.createElement("div",{className:"projectsList__list"},this.makeList(Object(k.a)(this.props.list)))}}]),t}(o.a.PureComponent),se=Object(C.b)(function(e){return{idUser:e.cabinet.idUser,list:Object(k.a)(e.cabinet.projects)}})(ie),le=(n(267),function(e){return o.a.createElement("section",{className:"projectsList"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"flex-column"},o.a.createElement("div",{className:"projectsList__about"},o.a.createElement("h3",null,"Your Projects")),se?o.a.createElement(se,null):null)))}),ue=(n(268),n(99).title),pe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={workMode:"default"},n.logOut=function(e){n.props.dispatch(X(n.props.idUser))},n.deletItem=function(e){n.props.dispatch(q(Object(x.a)({},e,{uid:n.props.firebase.getCurrentUser().uid})))},n.changeWorkMode=function(e){n.setState(Object(x.a)({},n.state,{workMode:e.action}))},n.componentDidMount=function(){g.on("EventDeleteItem",n.deletItem),g.on("EventChangeWorkMode",n.changeWorkMode)},n.componentWillUnmount=function(){g.off("EventDeleteItem",n.deletItem),g.off("EventChangeWorkMode",n.changeWorkMode)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.active?o.a.createElement(a.Fragment,null,o.a.createElement(Z,{title:ue,idUser:this.props.idUser}),"newProject"===this.state.workMode?o.a.createElement(oe,{workMode:this.state.workMode}):null,o.a.createElement(le,null)):this.props.firebase.getCurrentUser()?o.a.createElement(J,{path:"/img/loading.gif",type:"Cabinet"}):o.a.createElement(v.a,{to:"/"})}}]),t}(o.a.PureComponent),me=Object(C.b)(function(e){return{idUser:e.cabinet.idUser,projects:Object(k.a)(e.cabinet.projects),active:e.cabinet.active}})(V(pe)),de=(n(269),V(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={config:n.props.config},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(this.props.firebase.getCurrentUser()){var e=this.state.config;return o.a.createElement(a.Fragment,null,o.a.createElement(Z,{title:e.title}),o.a.createElement("section",{className:"About"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"col-12"},o.a.createElement("div",{className:"information"},o.a.createElement("img",{alt:"img",className:"logoAbout",src:"/constructor/img/about.jpg"}),o.a.createElement("p",{className:"developer"},o.a.createElement("span",null,"Developer:")," ",e.about.developer),o.a.createElement("p",{className:"year"},o.a.createElement("span",null,"Year:")," ",e.about.year))))))}return o.a.createElement(v.a,{to:"/"})}}]),t}(o.a.PureComponent))),he=function(e){return function(){var t=Object(L.a)(z.a.mark(function t(n,a,o){var r,c;return z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.firebase,c=e.projects.map(function(t){return t.id===e.idProject&&(t.components=Object(k.a)(e.components)),t}),t.next=4,r.db.collection("users").doc(e.uid).update({projects:JSON.parse(JSON.stringify(c))}).then(function(t){var a,o=e.projects.find(function(t){return t.id===e.idProject});n({type:"LOAD_UPDATE_PROJECT",idProject:(a={components:Object(k.a)(o.components),idProject:e.idProject}).idProject,components:a.components})}).catch(function(e){return n(A(e.message))});case 4:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}()},be=n(49),fe=n(50);function ge(){var e=Object(be.a)(["\n    position: absolute;\n    transform: translate(-50%);\n    font-size: ",";\n    color: ",";\n    text-align: center;\n    margin: 0;\n"]);return ge=function(){return e},e}var ve=fe.a.h1.attrs(function(e){return{style:{display:e.shadowDisplay?"none":"block",left:e.coordX?e.coordX:"50%",top:e.coordY}}})(ge(),function(e){return e.size},function(e){return e.textColor}),je=function(e){var t=Object(a.useState)(e.id),n=Object(F.a)(t,1)[0],r=Object(a.useState)(Object(x.a)({},e.sizeParenBox)),c=Object(F.a)(r,1)[0],i=Object(a.useState)(e.color),s=Object(F.a)(i,2),l=s[0],u=s[1],p=Object(a.useState)(e.size?e.size:120),m=Object(F.a)(p,2),d=m[0],h=m[1],b=Object(a.useState)(e.content?e.content:e.children),f=Object(F.a)(b,2),v=f[0],j=f[1],E=Object(a.useState)(null),O=Object(F.a)(E,2),C=O[0],P=O[1],w=Object(a.useState)(e.coords.left?{x:e.coords.left,y:e.coords.top}:null),S=Object(F.a)(w,2),y=S[0],k=S[1],N=function(e){g.emit("EventInstrumentPanel",{target:"text",id:n,sizeTextValue:d}),e.stopPropagation()},I=function(e){u(e)},B=function(e){var t=e.size;h(t)},A=function(e){var t=e.content;j(t)},M=function(e){var t=e.pageX-C.x,n=e.pageY-C.y;n=n<=0?0:n;var a=100*(t=t<=130?130:t)/c.width,o=100*n/c.height,r={x:a.toFixed(1)+"%",y:o.toFixed(1)+"%",shadowDisplay:"drag"===e.type};k(r),"dragend"===e.type&&g.emit("EventUpdatePosition",r),e.stopPropagation()};return Object(a.useEffect)(function(e){return g.on("EventChangeColorText".concat(n),I),g.on("EventChangeSizeText".concat(n),B),g.on("EventChangeContentText".concat(n),A),function(){g.off("EventChangeColorText".concat(n),I),g.off("EventChangeSizeText".concat(n),B),g.off("EventChangeContentText".concat(n),A)}}),o.a.createElement(ve,{onClick:N,textColor:l||"red",size:d?d+"px":"120px",draggable:!0,onMouseDown:function(e){var t=e.target.getBoundingClientRect(),n=t.left,a=t.top,o=t.width,r=t.height;P({x:e.pageX-n-o/2,y:e.pageY-a+r/2.8}),e.stopPropagation()},onDragStart:N,onDrag:M,onDragEnd:M,onWheel:function(e){if(e.shiftKey&&-100===e.deltaY){var t=d+1;h(t=t>200?200:t),g.emit("EventUpdateSizeText",t)}if(e.shiftKey&&100===e.deltaY){var n=d-1;h(n=n<=10?10:n),g.emit("EventUpdateSizeText",n)}e.stopPropagation()},coordX:y?y.x:null,coordY:y?y.y:null,shadowDisplay:!!y&&y.shadowDisplay},v)};function Ee(){var e=Object(be.a)(["\n    position: relative;\n    width: 100%;\n    height: 95vh;\n    background-size: cover;\n    background-color: ",";\n    background-image: url(",");\n"]);return Ee=function(){return e},e}var Oe=fe.a.div(Ee(),function(e){return e.backgroundColor},function(e){return e.backgroundImage}),Ce=function(e){console.log("BG");var t=Object(a.useState)(e.id),n=Object(F.a)(t,1)[0],r=Object(a.useState)(0),c=Object(F.a)(r,2),i=c[0],s=c[1],l=o.a.createRef(),u=Object(a.useState)(e.background),p=Object(F.a)(u,2),m=p[0],d=p[1],h=Object(a.useState)(e.backgroundImage?e.backgroundImage:null),b=Object(F.a)(h,2),f=b[0],v=b[1],j=function(e){d(e)},E=function(e){var t=e.urlFull;v(t)};return Object(a.useEffect)(function(){return 0===i&&function(e){s(i+1),l.current.focus();var t=l.current.getBoundingClientRect();g.emit("EventSaveWidth",{width:t.width,height:t.height})}(),g.on("EventChangeColorBackground".concat(n),j),g.on("EventSetBackgroundImage".concat(n),E),function(){g.off("EventChangeColorBackground".concat(n),j),g.off("EventSetBackgroundImage".concat(n),E)}}),o.a.createElement(Oe,{ref:l,onClick:function(e){g.emit("EventInstrumentPanel",{target:"background",id:n}),e.stopPropagation()},backgroundColor:m,backgroundImage:f},e.children)},Pe=function(e){var t=Object(a.useState)(e.id),n=Object(F.a)(t,1)[0],r=Object(a.useState)(e.content?e.content:null),c=Object(F.a)(r,1)[0],i=Object(a.useState)(e.type),s=Object(F.a)(i,1)[0];return"text"===s?o.a.createElement(je,{sizeParenBox:Object(x.a)({},e.sizeParenBox),id:n,coords:Object(x.a)({},e.coords),key:"text".concat(n)},c):"background"===s?o.a.createElement(Ce,{id:n,key:"bg".concat(n)}):void 0};n(271);var we=function(e){var t=Object(a.useState)(e.path),n=Object(F.a)(t,1)[0];return o.a.createElement("div",{onClick:function(e){g.emit("EventImageView",{action:!1,target:null}),e.stopPropagation()},className:"ImageViewer"},o.a.createElement("img",{src:n,alt:"fullImage"}))},Se=n(121),ye=(n(434),function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(c)))).state={instrumentPanel:Object(x.a)({},n.props.instrumentPanel),componentsStats:{content:null,fontSize:null,color:null,backgroundImage:null,image:null,coords:{left:null,top:null}},images:null},n.updateSizeText=function(e){n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentsStats:Object(x.a)({},n.state.componentsStats,{fontSize:e})}))},n.closePanel=function(e){g.emit("EventClosePanel",{close:!1})},n.setSize=function(e){var t=n.state.instrumentPanel.idComponent,a=e.target.value>200?200:e.target.value;n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentsStats:Object(x.a)({},n.state.componentsStats,{fontSize:a})}),function(){return g.emit("EventChangeSizeText".concat(t),{size:a})}),e.stopPropagation()},n.setContent=function(e){var t=n.state.instrumentPanel.idComponent,a=e.target.value;n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel),componentsStats:Object(x.a)({},n.state.componentsStats,{content:a})}),function(){return g.emit("EventChangeContentText".concat(t),{content:a})}),e.stopPropagation()},n.updatePosition=function(e){console.log("update"),n.setState(Object(x.a)({},n.state,{componentsStats:Object(x.a)({},n.state.componentsStats,{coords:Object(x.a)({},n.state.componentsStats.coords,{left:e.x,top:e.y})})}))},n.setColor=function(e){n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel,{colorPickerActive:!n.state.instrumentPanel.colorPickerActive})})),e.stopPropagation()},n.updateBimageStats=function(e){var t=e.urlFull;n.setState(Object(x.a)({},n.state,{componentsStats:Object(x.a)({},n.state.componentsStats,{backgroundImage:t})}))},n.handleChangeComplete=function(e){var t=e.rgb,a="rgb(".concat(t.r,",").concat(t.g,",").concat(t.b,",").concat(t.a,")"),o=n.state.instrumentPanel.idComponent;"background"===n.state.instrumentPanel.target?n.setState(Object(x.a)({},n.state,{componentsStats:Object(x.a)({},n.state.componentsStats,{color:a})}),function(){return g.emit("EventChangeColorBackground".concat(o),a)}):"text"===n.state.instrumentPanel.target&&n.setState(Object(x.a)({},n.state,{componentsStats:Object(x.a)({},n.state.componentsStats,{color:a})}),function(){return g.emit("EventChangeColorText".concat(o),a)})},n.saveChanges=function(e){g.emit("EventSaveChangesComponent",Object(x.a)({},n.state.componentsStats,{type:n.state.instrumentPanel.target})),e.stopPropagation()},n.searchImage=function(e){var t=n.state.instrumentPanel.idComponent;g.emit("EventModalSearchOn",{idComponent:t}),e.stopPropagation()},n.makePanelInstruments=function(e){var t=n.state.instrumentPanel.colorPickerActive,r=n.state.componentsStats.fontSize,c=n.state.componentsStats.coords;switch(e){case"text":return o.a.createElement(a.Fragment,null,o.a.createElement("p",{className:"titleInstument"},"Position:",o.a.createElement("span",{className:"textCoordsPanel"}," ",c.left?c.left+" / "+c.top:"drop for active")),o.a.createElement("p",{className:"titleInstument"},"Color: "),o.a.createElement("input",{onClick:n.setColor,className:"button_switchColor",type:"button",value:"color pick"}),o.a.createElement("p",{className:"titleInstument"},"Text size: "),o.a.createElement("input",{onChange:n.setSize,type:"number",min:"10",max:"200",value:r||120}),t?o.a.createElement(Se.SketchPicker,{onChangeComplete:n.handleChangeComplete}):null,o.a.createElement("p",{className:"titleInstument"},"Content: "),o.a.createElement("input",{onChange:n.setContent,maxLength:"20",type:"text",defaultValue:"Title"}),o.a.createElement("input",{onClick:n.saveChanges,className:"saveButtonInstument",type:"button",value:"save changes"}));case"background":return o.a.createElement(a.Fragment,null,o.a.createElement("p",{className:"titleInstument"},"Color: "),o.a.createElement("input",{onClick:n.setColor,className:"button_switchColor",type:"button",value:"color pick"}),t?o.a.createElement(Se.SketchPicker,{onChangeComplete:n.handleChangeComplete}):null,o.a.createElement("input",{onClick:n.searchImage,className:"ImageSearchButton",type:"button",value:"background-image"}),o.a.createElement("input",{onClick:n.saveChanges,className:"saveButtonInstument",type:"button",value:"save changes"}));default:return o.a.createElement("p",{className:"warningInstruments"},"Select elements for accses edit instruments")}},n.componentDidUpdate=function(e,t){var a=t.instrumentPanel.target!==n.props.instrumentPanel.target;(t.instrumentPanel.idComponent!==n.props.instrumentPanel.idComponent||a)&&n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.props.instrumentPanel,{colorPickerActive:!1}),componentsStats:{content:null,fontSize:null,color:null,backgroundImage:null,image:null,coords:{left:null,top:null}}}))},n.componentDidMount=function(e){g.on("EventUpdateSizeText",n.updateSizeText),g.on("EventSetBImageInstumentPanel",n.updateBimageStats),g.on("EventUpdatePosition",n.updatePosition)},n.componentWillUnmount=function(e){g.off("EventUpdateSizeText",n.updateSizeText),g.off("EventUpdatePosition",n.updatePosition)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.instrumentPanel.instrumentActive;return o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:"instumentsPanel"},o.a.createElement("button",{onClick:this.closePanel,className:"closeInstrumentsPanel"},o.a.createElement(K,{path:"/img/close.svg"})),o.a.createElement("h3",null,"Instruments"),e?o.a.createElement("p",{className:"TextComponent"},this.state.instrumentPanel.target):null,e?o.a.createElement("div",{className:"instuments"},this.makePanelInstruments(this.state.instrumentPanel.target)):null))}}]),t}(o.a.PureComponent)),ke=(n(435),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={components:Object(x.a)({},n.props.components),sizeParenBox:Object(x.a)({},n.props.sizeParenBox),title:"Title"},n.addText=function(e){var t=n.props.countComponents,a=o.a.createElement(Pe,{sizeParenBox:n.props.sizeParenBox,key:"text".concat(t),content:"Title",id:t,target:"Header",type:"text"});g.emit("EventBuildComponents",{target:"Header",type:"text",component:a}),e.stopPropagation()},n.addBackground=function(e){var t=n.props.countComponents,a=o.a.createElement(Pe,{key:"bg".concat(t),id:t,target:"Header",type:"background"});g.emit("EventBuildComponents",{target:"Header",type:"background",component:a}),e.stopPropagation()},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log("menu"),o.a.createElement("div",{className:"ComponentsMenu"},o.a.createElement("button",{onClick:this.addBackground,className:"ImageTool CompoentnsMenu_button"},o.a.createElement("span",null,"Image")),o.a.createElement("button",{onClick:this.addText,className:"TextTool CompoentnsMenu_button"},o.a.createElement("span",null,"Text")),o.a.createElement("button",{disabled:"Header"===this.state.components.name,className:"ButtonTool CompoentnsMenu_button"},o.a.createElement("span",null,"Button")),o.a.createElement("button",{className:"VideoTool CompoentnsMenu_button"},o.a.createElement("span",null,"Video")))}}]),t}(o.a.PureComponent));function xe(){var e=Object(be.a)(["\n    position: absolute;\n    display: ","\n    "]);return xe=function(){return e},e}var Ne=fe.a.div.attrs(function(e){return{style:{left:e.coordX,top:e.coordY}}})(xe(),function(e){return e.shadowDisplay}),Ie=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={viewComponentMenu:!1,shiftX:0,shiftY:0,coordsX:"50%",coordsY:"0",shadowDisplay:"block"},n.componentMenu=function(e){n.setState({viewComponentMenu:!n.state.viewComponentMenu}),e.stopPropagation()},n.saveCoords=function(e){var t=n.controlBox.getBoundingClientRect().left,a=n.controlBox.getBoundingClientRect().top;n.setState(Object(x.a)({},n.state,{shiftX:e.pageX-t,shiftY:e.pageY-a+55})),e.stopPropagation()},n.drag=function(e){n.state.viewComponentMenu||n.setState(Object(x.a)({},n.state,{coordsX:e.pageX-n.state.shiftX+"px",coordsY:e.pageY-n.state.shiftY+"px",shadowDisplay:"drag"===e.type?"none":"block"})),e.stopPropagation()},n.controlBox=null,n.refControll=function(e){return n.controlBox=e},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement(a.Fragment,null,this.props.menuActive?o.a.createElement(Ne,{ref:this.refControll,className:"ControllersEditComponent",coordX:this.state.coordsX,coordY:this.state.coordsY,draggable:!this.state.viewComponentMenu,onMouseDown:this.saveCoords,onClick:this.componentMenu,onDrag:this.drag,onDragEnd:this.drag,shadowDisplay:this.state.shadowDisplay},o.a.createElement(K,{draggable:!0,onClick:this.componentMenu,className:"addButton",path:"/img/addButton.png"}),this.state.viewComponentMenu?o.a.createElement(ke,{sizeParenBox:this.props.sizeParenBox,countComponents:this.props.countComponents,components:Object(x.a)({},this.props.components)}):null):null)}}]),t}(o.a.PureComponent),Be=(n(436),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={idProject:n.props.id,components:Object(x.a)({},n.props.children)},n.changeMode=function(e){if(!n.props.editStart){var t=e.currentTarget.getBoundingClientRect(),a=t.width,o=t.height;g.emit("EventModeEdit",Object(x.a)({},n.state,{width:a,height:o}))}},n.refBox=null,n.refBackground=function(e){return n.refBox=e},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement(a.Fragment,null,o.a.createElement("div",{onClick:this.changeMode,className:"Header"},o.a.createElement(Ce,{id:"MainBackgroundHeader",background:"grey"},this.props.children.build.componentJSX&&"text"===this.props.children.build.type?this.props.children.build.componentJSX:null),this.props.editStart?null:o.a.createElement("p",{className:"warningEdit"},"Click for start edit"),this.state.readyBuild?null:o.a.createElement(Ie,{countComponents:this.props.countComponents,menuActive:this.props.menuActive,components:Object(x.a)({},this.state.components),sizeParenBox:this.props.sizeParenBox})))}}]),t}(o.a.PureComponent)),Ae=(n(437),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={idProject:parseInt(n.props.match.params.param),editComponent:{name:null,build:{name:null,target:null,type:null,mainBoxWidth:null,mainBoxHeight:null,buildGetComponents:!1,components:[],componentJSX:[]}},instrumentPanel:{colorPickerActive:!1,instrumentActive:!1,target:"",idComponent:null},menuActive:!1,editStart:!1,modalSearch:!1,modalImageViewer:{action:!1,image:null}},n.modalSearchOn=function(e){n.setState(Object(x.a)({},n.state,{modalSearch:!n.state.modalSearch}))},n.imageViewerSwitch=function(e){n.setState(Object(x.a)({},n.state,{modalImageViewer:Object(x.a)({},n.state.modalImageViewer,{action:e.action,target:e.target})}))},n.workModeEdit=function(e){n.state.editStart||n.setState(Object(x.a)({},n.state,{idProject:e.idProject,editComponent:Object(x.a)({},n.state.editComponent,e.components,{mainBoxWidth:e.width,mainBoxHeight:e.height}),menuActive:!0,editStart:!0}))},n.openInstrument=function(e){var t=n.state.instrumentPanel.target!==e.target,a=n.state.instrumentPanel.instumentActive;t&&n.state.editStart&&!a&&n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel,{instrumentActive:!0,sizeTextValue:e.sizeTextValue,idComponent:e.id,target:e.target})}))},n.closePanel=function(e){n.setState(Object(x.a)({},n.state,{instrumentPanel:Object(x.a)({},n.state.instrumentPanel,{colorPickerActive:!1,instrumentActive:e.close})}))},n.addComponentsFromBD=function(e){var t=[];n.setState(Object(x.a)({},n.state,{editComponent:Object(x.a)({},n.state.editComponent,{build:Object(x.a)({},n.state.editComponent.build,{buildGetComponents:!0})})}),function(){e.forEach(function(e){var a=n.state.editComponent.build.componentJSX.length,r=o.a.createElement(Pe,{sizeParenBox:Object(x.a)({},n.state.sizeParenBox),coords:Object(x.a)({},e.coords),id:a,type:e.type,key:"".concat(e.type).concat(a),content:e.content?e.content:"Title"}),c={type:e.type,component:r};t.push({component:r,inform:c})}),n.addComponent({target:"Header",dataBaseData:t,mode:"DB"})})},n.addComponent=function(e){var t=n.state.editComponent.build.componentJSX;if("DB"!==e.mode)n.setState(Object(x.a)({},n.state,{editComponent:Object(x.a)({},n.state.editComponent,{build:Object(x.a)({},n.state.editComponent.build,{target:e.target,type:e.type,componentJSX:[].concat(Object(k.a)(t),[Object(x.a)({},e.component)])})})}));else{var a=[];e.dataBaseData.forEach(function(e){a.push(e.component)}),n.setState(Object(x.a)({},n.state,{editComponent:Object(x.a)({},n.state.editComponent,{build:Object(x.a)({},n.state.editComponent.build,{target:e.target,type:"text",componentJSX:[].concat(Object(k.a)(t),a)})})}))}},n.saveChangesComponent=function(e){var t=n.props.userData,a=Object(x.a)({},e,{name:n.state.editComponent.name});n.setState(Object(x.a)({},n.state,{editComponent:Object(x.a)({},n.state.editComponent,{build:Object(x.a)({},n.state.editComponent.build,{components:[].concat(Object(k.a)(n.state.editComponent.build.components),[a])})})}),function(){return n.props.dispatch(he({uid:t.idUser,projects:Object(k.a)(t.projects),components:Object(k.a)(n.state.editComponent.build.components),idProject:n.state.idProject}))})},n.saveWidth=function(e){n.setState({sizeParenBox:Object(x.a)({},e)})},n.componentDidMount=function(){var e=n.props.userData,t=e.currentProjectsData;if(e.active&&!t.loadProject&&t.haveUpdateLoading){var a=e.projects.find(function(e){return e.id===n.state.idProject});n.props.dispatch(I({id:a.id,typeProject:a.type,components:Object(k.a)(a.components)}))}g.on("EventBuildComponents",n.addComponent),g.on("EventSaveChangesComponent",n.saveChangesComponent),g.on("EventSaveWidth",n.saveWidth),g.on("EventClosePanel",n.closePanel),g.on("EventModalSearchOn",n.modalSearchOn),g.on("EventInstrumentPanel",n.openInstrument),g.on("EventImageView",n.imageViewerSwitch),g.on("EventModeEdit",n.workModeEdit)},n.componentWillUnmount=function(){n.props.userData.active&&n.props.dispatch(N(!0)),g.off("EventBuildComponents",n.addComponent),g.off("EventSaveChangesComponent",n.saveChangesComponent),g.off("EventSaveWidth",n.saveWidth),g.off("EventModalSearchOn",n.modalSearchOn),g.off("EventClosePanel",n.closePanel),g.off("EventInstrumentPanel",n.openInstrument),g.off("EventImageView",n.imageViewerSwitch),g.off("EventModeEdit",n.workModeEdit)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){console.log("build comp render");var e=this.props.userData,t=e.currentProjectsData,n=this.state.instrumentPanel.instrumentActive;return e.active&&t.loadProject?o.a.createElement(a.Fragment,{key:"build"},this.state.modalImageViewer.action?o.a.createElement(we,{key:"ImageViewer",path:this.state.modalImageViewer.target}):null,this.state.modalSearch?o.a.createElement(oe,{idComponent:this.state.instrumentPanel.idComponent,key:"ModalWindow",workMode:"Search"}):null,n?o.a.createElement(ye,{key:"InstrumentsPanel",editComponent:Object(x.a)({},this.state.editComponent),instrumentPanel:Object(x.a)({},this.state.instrumentPanel)}):null,o.a.createElement(Z,{key:"Header",title:"Constructor"}),o.a.createElement(Be,{key:"HeaderBuild",currentProjectsData:Object(x.a)({},this.props.userData.currentProjectsData),editStart:this.state.editStart,countComponents:this.state.editComponent.build.componentJSX.length,menuActive:this.state.menuActive,sizeParenBox:this.state.sizeParenBox,id:t.idProject},Object(x.a)({},this.state.editComponent,{name:"Header"}))):this.props.firebase.getCurrentUser()?o.a.createElement(J,{key:"Loader",path:"/img/loading.gif",type:"build"}):o.a.createElement(v.a,{to:"/"})}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.userData,a=n.currentProjectsData,o=(a.components.length,this.state.editComponent.build.buildGetComponents);if(e.userData.currentProjectsData.loadProject===a.loadProject&&a.haveUpdateLoading){var r=n.projects.find(function(e){return e.id===t.state.idProject});this.props.dispatch(I({id:r.id,typeProject:r.type,components:Object(k.a)(r.components)}))}a.loadProject&&this.state.editStart&&!o&&this.addComponentsFromBD(Object(k.a)(a.components))}}]),t}(o.a.PureComponent)),Me=Object(C.b)(function(e){return{userData:{active:e.cabinet.active,idUser:e.cabinet.idUser,projects:Object(k.a)(e.cabinet.projects),currentProjectsData:Object(x.a)({},e.builder)}}})(V(Ae)),Ue=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(o)))).state={firebase:n.props.firebase,firebaseLoadState:!1},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.auth.onAuthStateChanged(function(t){var n;e.state.firebaseLoadState||(t&&(console.log("load"),e.props.dispatch((n=t.uid,function(){var e=Object(L.a)(z.a.mark(function e(t,a,o){var r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.firebase,e.next=3,r.db.collection("users").doc(n).get().then(function(e){var a=e.data();t(B({uid:n,projects:Object(k.a)(a.projects)}))}).catch(function(e){console.error(e.message),t(A(e.message))});case 3:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()))),e.setState(Object(x.a)({},e.state,{firebaseLoadState:!0})))})}},{key:"render",value:function(){var e=this;return this.state.firebaseLoadState?(console.log("app"),o.a.createElement(v.d,null,o.a.createElement(v.b,{path:"/",exact:!0,render:function(e){return o.a.createElement(G,e)}}),o.a.createElement(v.b,{path:"/Cabinet/",exact:!0,component:me}),o.a.createElement(v.b,{path:"/Cabinet/About",render:function(t){return o.a.createElement(de,Object.assign({},t,{config:e.props.config}))}}),o.a.createElement(v.b,{path:"/Cabinet/Build/:param",component:Me}),o.a.createElement(v.b,{path:"*",component:G}),o.a.createElement(v.b,{path:"/crashPage",component:j}))):o.a.createElement(J,{path:"/img/loading.gif",type:"application"})}}]),t}(o.a.PureComponent),De=Object(C.b)()(V(Ue));n(438);d.saveSession("SESSION");var Te=n(99);c.a.render(o.a.createElement(O.a,null,o.a.createElement(E,null,o.a.createElement(C.a,{store:R},o.a.createElement(De,{config:Te})))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/constructor",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/constructor","/service-worker.js");i?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):s(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker.")})):s(t,e)})}}()},99:function(e){e.exports={title:"Constructor",CabinetIcon:"/img/logo.svg",about:{developer:"Pavel Petrovich",year:"2019"}}}},[[182,1,2]]]);
//# sourceMappingURL=main.dbca3b46.chunk.js.map